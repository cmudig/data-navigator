(()=>{"use strict";const e={transformData:e=>(console.log("transforming!",e),outputData),build:t=>{let o=null;if(!t.data)return void console.error("No data found, cannot enter: options.data must contain a valid hash object of data for dataNavigator.build");e.currentOptions=t,o=t.settings&&t.settings.firstNode?t.settings.firstNode:Object.keys(t.data)[0];const n=()=>{console.log("entry button clicked!",t),e.move.to(o)};if(t.id){console.log("building navigator!",t);const i=document.createElement("div");i.id="dn-root-"+t.id,i.classList.add("dn-root"),i.style.width=t.width||"100%",i.style.height=t.height;const s=document.createElement("button");return s.id="dn-entry-button-"+t.id,s.classList.add("dn-entry-button"),s.innerText="Enter navigation area",s.addEventListener("click",n),i.appendChild(s),console.log("dataNavigator.keyBindings",e.keyBindings),Object.keys(e.keyBindings).forEach((t=>{e.directions[e.keyBindings[t]]=t})),console.log("directions",e.directions),t.navigation&&Object.keys(t.navigation).forEach((o=>{const n=t.navigation[o];n.rebindKeycodes&&Object.keys(n.rebindKeycodes).forEach((t=>{e.directions[t]=n.rebindKeycodes[t]}))})),e.keyBindings={},Object.keys(e.directions).forEach((t=>{e.keyBindings[e.directions[t]]=t})),console.log("keybinds",e.keyBindings),e.prepNode(o),i}console.error("No id found: options.id must be specified for dataNavigator.build")},prepNode:(t,o)=>{const n=e.currentOptions,i=document.createElement("figure");i.setAttribute("role","figure"),i.id=t,i.classList.add("dn-node"),n.data[t].cssClass&&i.classList.add(n.data[t].cssClass),i.style.width=parseFloat(n.data[t].width||"0")+"px",i.style.height=parseFloat(n.data[t].height||"0")+"px",i.style.left=parseFloat(n.data[t].x||"0")+"px",i.style.top=parseFloat(n.data[t].y||"0")+"px",i.setAttribute("tabindex","-1"),i.addEventListener("keydown",e.handleKeydownInteraction),i.addEventListener("focus",e.handleFocusInteraction);const s=document.createElement("div");if(console.log(t),s.setAttribute("role","img"),s.classList.add("dn-node-text"),n.showText&&(s.innerText=n.data[t].description),s.setAttribute("aria-label",n.data[t].description),i.appendChild(s),root.appendChild(i),o){const n=document.getElementById(o);e.currentFocus=t,i.focus(),n.removeEventListener("keydown",e.handleKeydownInteraction),n.removeEventListener("focus",e.handleFocusInteraction),n.remove()}},listeners:{},move:{}};e.listeners.key=()=>{},e.listeners.touch=()=>{},e.describe=(e,t)=>{console.log("describing",e),console.log("describe options",t);const o=Object.keys(e);let n="";return o.forEach((o=>{n+=`${t.omitKeyNames?"":o+": "}${e[o]}.`})),n+=t.semanticLabel||" Data point.",n},e.move.to=t=>{const o=document.getElementById(t);o&&(console.log("moving to target!",o),e.currentFocus=t,o.focus())},e.move.inDirection=t=>{if(e.currentFocus){const o=e.currentOptions.data[e.currentFocus],n="left"===t?o.lr[0]:"right"===t?o.lr[1]:"up"===t?o.ud[0]:"down"===t?o.ud[1]:"forward"===t?o.fb[0]:"backward"===t?o.fb[1]:"parent"===t?o.pc[0]:"child"===t?o.pc[1]:null;console.log("currentFocus",e.currentFocus),console.log("direction",t),console.log("d",o),console.log("target",n),n&&e.prepNode(n,e.currentFocus)}},e.move.left=()=>{e.move.inDirection("left")},e.move.right=()=>{e.move.inDirection("right")},e.move.up=()=>{e.move.inDirection("up")},e.move.down=()=>{e.move.inDirection("down")},e.move.forward=()=>{e.move.inDirection("forward")},e.move.backward=()=>{e.move.inDirection("backward")},e.move.toParent=()=>{e.move.inDirection("parent")},e.move.toFirstChild=()=>{e.move.inDirection("child")},e.currentFocus=null,e.currentOptions=null,e.handleKeydownInteraction=t=>{console.log("key down",t),console.log("dataNavigator.keyBindings",e.keyBindings);const o=e.keyBindings[t.code];o&&(console.log("MOVING (attempt)",o),t.preventDefault(),e.move.inDirection(o))},e.handleFocusInteraction=e=>{console.log("focus",e)},e.select=()=>{},e.escape=()=>{},e.undo=()=>{},e.redo=()=>{},e.keyBindings={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Period:"forward",Comma:"backward",Escape:"parent",Enter:"child"},e.directions={down:"",left:"",right:"",up:"",backward:"",child:"",parent:"",forward:""};const t={category:"abc",group:"xyz",series:"ijk",level:"012"};let o={};const n={omitKeyNames:!1},i=document.querySelectorAll("rect"),s=e=>{if(console.log(e),e){const t=e.id.substring(4);return{x:t,d:{category:t.substring(0,1),group:t.substring(1,2),series:t.substring(2,3),level:t.substring(3,4),id:e.id}}}};i.forEach((i=>{if(i.id.includes("ref-")){const r=s(i),d=r.x,c=r.d,a=e=>document.getElementById(`ref-${e}`);console.log(t.series.indexOf(c.series-1)),console.log(d.replace(c.series,t.series.substring(t.series.indexOf(c.series-1),t.series.indexOf(c.series-1)+1)));const l=(e,o)=>{const n=t[e].indexOf(c[e]);let i="";if(n+o>-1&&n+o<3){const s=t[e].substring(n+o,n+o+1);i=d.replace(c[e],s)}return a(i)?i:""},u=l("series",-1),g=l("series",1),y=l("category",-1),p=l("category",1),h=l("group",-1),f=l("group",1),b="byj1"===d||"byj2"===d?l("level",-1):"",m="byj1"===d||"byj0"===d?l("level",1):"";console.log(u,a(u));const v=[];u&&v.push({id:u,...s(a(u)).d}),g&&v.push({id:g,...s(a(g)).d}),y&&v.push({id:y,...s(a(y)).d}),p&&v.push({id:p,...s(a(p)).d}),h&&v.push({id:h,...s(a(h)).d}),f&&v.push({id:f,...s(a(f)).d}),b&&v.push({id:b,...s(a(b)).d}),m&&v.push({id:m,...s(a(m)).d}),o[d]={d:c,x:+i.getAttribute("x")-2,y:+i.getAttribute("y")-2,width:+i.getAttribute("width"),height:+i.getAttribute("height"),ref:"ref-"+d,id:d,cssClass:"dn-test-class",edges:v,lr:[u,g],ud:[y,p],fb:[h,f],pc:[b,m],description:e.describe(c,n),semantics:"node"},console.log(o[d])}})),console.log("dataUsedInChart",o),console.log("keys",Object.keys(o));let r={data:o,id:"data-navigator-schema",settings:{firstNode:"byj1",rendering:"on-demand",manualEventHandling:!1},root:{cssClass:"",width:"100%",height:0},navigation:{leftRight:{key:"series",rebindKeycodes:{left:"KeyA",right:"KeyD"},hooks:{start:e=>{console.log("start of left/right",e)},complete:e=>{console.log("end of left/right",e)}}},upDown:{key:"category",rebindKeycodes:{up:"KeyW",down:"KeyS"}},forwardBackward:{key:"group",rebindKeycodes:{forward:"KeyE",backward:"KeyQ"}},parentChild:{key:"level"}}},d=e.build(r);document.getElementById("root").appendChild(d)})();