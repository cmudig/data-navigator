(()=>{"use strict";const e={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Period:"forward",Comma:"backward",Escape:"parent",Enter:"child"},o=(e,o)=>{console.log("describing",e),console.log("describe options",o);const t=Object.keys(e);let i="";return t.forEach((t=>{i+=`${o.omitKeyNames?"":t+": "}${e[t]}.`})),i+=o.semanticLabel||" Data point.",i},t={category:"abc",group:"xyz",series:"ijk",level:"012"};let i={};const n={omitKeyNames:!1},d=document.querySelectorAll("rect"),s=e=>{if(console.log(e),e){const o=e.id.substring(4);return{x:o,d:{category:o.substring(0,1),group:o.substring(1,2),series:o.substring(2,3),level:o.substring(3,4),id:e.id}}}};d.forEach((e=>{if(e.id.includes("ref-")){const d=s(e),r=d.x,c=d.d,a=e=>document.getElementById(`ref-${e}`);console.log(t.series.indexOf(c.series-1)),console.log(r.replace(c.series,t.series.substring(t.series.indexOf(c.series-1),t.series.indexOf(c.series-1)+1)));const l=(e,o)=>{const i=t[e].indexOf(c[e]);let n="";if(i+o>-1&&i+o<3){const d=t[e].substring(i+o,i+o+1);n=r.replace(c[e],d)}return a(n)?n:""},g=l("series",-1),u=l("series",1),y=l("category",-1),h=l("category",1),p=l("group",-1),m=l("group",1),f="byj1"===r||"byj2"===r?l("level",-1):"",b="byj1"===r||"byj0"===r?l("level",1):"";console.log(g,a(g));const v=[];g&&v.push({direction:-1,dimension:"series",id:g,d:{...s(a(g)).d}}),u&&v.push({direction:1,dimension:"series",id:u,d:{...s(a(u)).d}}),y&&v.push({direction:-1,dimension:"category",id:y,d:{...s(a(y)).d}}),h&&v.push({direction:1,dimension:"category",id:h,d:{...s(a(h)).d}}),p&&v.push({direction:1,dimension:"group",id:p,d:{...s(a(p)).d}}),m&&v.push({direction:-1,dimension:"group",id:m,d:{...s(a(m)).d}}),f&&v.push({direction:-1,dimension:"level",id:f,d:{...s(a(f)).d}}),b&&v.push({direction:1,dimension:"level",id:b,d:{...s(a(b)).d}}),i[r]={d:c,x:+e.getAttribute("x")-2,y:+e.getAttribute("y")-2,width:+e.getAttribute("width"),height:+e.getAttribute("height"),ref:"ref-"+r,id:r,cssClass:"dn-test-class",edges:v,lr:[g,u],ud:[y,h],fb:[p,m],pc:[f,b],description:o(c,n),semantics:"node"},console.log(i[r])}})),console.log("dataUsedInChart",i),console.log("keys",Object.keys(i));let r=(o=>{let t={},i=null,n=e,d={down:{axis:"upDown",keyCode:"",direction:1},left:{axis:"leftRight",keyCode:"",direction:-1},right:{axis:"leftRight",keyCode:"",direction:1},up:{axis:"upDown",keyCode:"",direction:-1},backward:{axis:"backwardForward",keyCode:"",direction:-1},child:{axis:"parentChild",keyCode:"",direction:1},parent:{axis:"parentChild",keyCode:"",direction:-1},forward:{axis:"backwardForward",keyCode:"",direction:1}};return t.transformData=e=>(console.log("transforming!",e),outputData),t.build=()=>{let e=null;if(!o.data)return void console.error("No data found, cannot enter: options.data must contain a valid hash object of data for dn.build");e=o.firstNode?o.firstNode:Object.keys(o.data)[0];const i=()=>{console.log("entry button clicked!",o),t.move.to(e)};if(o.id){console.log("building navigator!",o);const s=document.createElement("div");s.id="dn-root-"+o.id,s.classList.add("dn-root"),s.style.width=o.width||"100%",s.style.height=o.height;const r=document.createElement("button");return r.id="dn-entry-button-"+o.id,r.classList.add("dn-entry-button"),r.innerText="Enter navigation area",r.addEventListener("click",i),s.appendChild(r),console.log("keyBindings",n),Object.keys(n).forEach((e=>{d[n[e]].keyCode=e})),console.log("directions",d),o.navigation&&Object.keys(o.navigation).forEach((e=>{const t=o.navigation[e];t.rebindKeycodes&&Object.keys(t.rebindKeycodes).forEach((e=>{d[e].keyCode=t.rebindKeycodes[e]}))})),n={},Object.keys(d).forEach((e=>{n[d[e].keyCode]=e})),console.log("keybinds",n),t.prepNode(e),s}console.error("No id found: options.id must be specified for dn.build")},t.prepNode=(e,n)=>{const d=document.createElement("figure");d.setAttribute("role","figure"),d.id=e,d.classList.add("dn-node"),o.data[e].cssClass&&d.classList.add(o.data[e].cssClass),d.style.width=parseFloat(o.data[e].width||"0")+"px",d.style.height=parseFloat(o.data[e].height||"0")+"px",d.style.left=parseFloat(o.data[e].x||"0")+"px",d.style.top=parseFloat(o.data[e].y||"0")+"px",d.setAttribute("tabindex","-1"),d.addEventListener("keydown",t.handleKeydownInteraction),d.addEventListener("focus",t.handleFocusInteraction);const s=document.createElement("div");if(console.log(e),s.setAttribute("role","img"),s.classList.add("dn-node-text"),o.showText&&(s.innerText=o.data[e].description),s.setAttribute("aria-label",o.data[e].description),d.appendChild(s),root.appendChild(d),n){const o=document.getElementById(n);i=e,d.focus(),o.removeEventListener("keydown",t.handleKeydownInteraction),o.removeEventListener("focus",t.handleFocusInteraction),o.remove()}},t.listeners={},t.move={},t.listeners.key=()=>{},t.listeners.touch=()=>{},t.move.to=e=>{const o=document.getElementById(e);o&&(console.log("moving to target!",o),i=e,o.focus())},t.move.inDirection=e=>{if(i){const n=o.data[i];if(n.edges){let s=null,r=0;const c=d[e],a=c.axis,l=o.navigation[a];if(l){const o=l.key;for(console.log("dimension",o),r=0;r<n.edges.length;r++){const e=n.edges[r];if(console.log("edge",e),console.log("d",n),o===e.dimension&&e.direction===c.direction){s=e.id;break}}console.log("currentFocus",i),console.log("direction",e),console.log("d",n),console.log("target",s),s&&t.prepNode(s,i)}}}},t.move.left=()=>{t.move.inDirection("left")},t.move.right=()=>{t.move.inDirection("right")},t.move.up=()=>{t.move.inDirection("up")},t.move.down=()=>{t.move.inDirection("down")},t.move.forward=()=>{t.move.inDirection("forward")},t.move.backward=()=>{t.move.inDirection("backward")},t.move.toParent=()=>{t.move.inDirection("parent")},t.move.toFirstChild=()=>{t.move.inDirection("child")},t.handleKeydownInteraction=e=>{const o=n[e.code];o&&(e.preventDefault(),t.move.inDirection(o))},t.handleFocusInteraction=e=>{console.log("focus",e)},t.select=()=>{},t.escape=()=>{},t.undo=()=>{},t.redo=()=>{},t})({data:i,id:"data-navigator-schema",firstNode:"byj1",rendering:"on-demand",manualEventHandling:!1,root:{cssClass:"",width:"100%",height:0},navigation:{leftRight:{key:"series",rebindKeycodes:{left:"KeyA",right:"KeyD"}},upDown:{key:"category",rebindKeycodes:{up:"KeyW",down:"KeyS"}},backwardForward:{key:"group",rebindKeycodes:{forward:"KeyE",backward:"KeyQ"}},parentChild:{key:"level"}},hooks:{navigation:e=>{console.log("navigating",e)},focus:e=>{console.log("focus",e)},selection:e=>{console.log("selection",e)},keydown:e=>{console.log("keydown",e)},pointerClick:e=>{console.log("clicked",e)}}});console.log(r),document.getElementById("root").appendChild(r.build())})();