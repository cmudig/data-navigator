(()=>{"use strict";const e={transformData:e=>(console.log("transforming!",e),{byj1:{d:{value:5,category:"b",group:"y",series:"j",level:"1",id:"ref-byj1"},ref:"ref-byj1",id:"byj1",cssClass:"dn-node",lr:["byi1","byk1"],ud:["ayj1","cyj1"],fb:["bxj1","bzj1"],pc:["byj0","byj2"],semantics:"node"}}),build:t=>{let o=null;if(!t.data)return void console.error("No data found, cannot enter: options.data must contain a valid hash object of data for dataNavigator.build");e.currentOptions=t,o=t.firstNode?t.firstNode:Object.keys(t.data)[0];const n=()=>{console.log("entry button clicked!",t),e.move.to(o)};if(t.id){console.log("building navigator!",t);const r=document.createElement("div");r.id="dn-root-"+t.id,r.classList.add("dn-root"),r.style.width=t.width||"100%",r.style.height=t.height;const i=document.createElement("button");return i.id="dn-entry-button-"+t.id,i.classList.add("dn-entry-button"),i.innerText="Enter navigation area",i.addEventListener("click",n),r.appendChild(i),e.prepNode(o),r}console.error("No id found: options.id must be specified for dataNavigator.build")},prepNode:(t,o)=>{const n=e.currentOptions,r=document.createElement("figure");r.setAttribute("role","figure"),r.id=t,r.classList.add("dn-node"),n.data[t].cssClass&&r.classList.add(n.data[t].cssClass),r.style.width=parseFloat(n.data[t].width||"0")+"px",r.style.height=parseFloat(n.data[t].height||"0")+"px",r.style.left=parseFloat(n.data[t].x||"0")+"px",r.style.top=parseFloat(n.data[t].y||"0")+"px",r.setAttribute("tabindex","-1"),r.addEventListener("keydown",e.handleKeydownInteraction),r.addEventListener("focus",e.handleFocusInteraction);const i=document.createElement("div");if(console.log(t),i.setAttribute("role","img"),i.classList.add("dn-node-text"),n.showText&&(i.innerText=n.data[t].description),i.setAttribute("aria-label",n.data[t].description),r.appendChild(i),root.appendChild(r),o){const n=document.getElementById(o);e.currentFocus=t,r.focus(),n.removeEventListener("keydown",e.handleKeydownInteraction),n.removeEventListener("focus",e.handleFocusInteraction),n.remove()}},listeners:{},move:{}};e.listeners.key=()=>{},e.listeners.touch=()=>{},e.describe=(e,t)=>{console.log("describing",e),console.log("describe options",t);const o=Object.keys(e);let n="";return o.forEach((o=>{n+=`${t.omitKeyNames?"":o+": "}${e[o]}.`})),n+=t.semanticLabel||" Data point.",n},e.move.to=t=>{const o=document.getElementById(t);o&&(console.log("moving to target!",o),e.currentFocus=t,o.focus())},e.move.inDirection=t=>{if(e.currentFocus){const o=e.currentOptions.data[e.currentFocus],n="left"===t?o.lr[0]:"right"===t?o.lr[1]:"up"===t?o.ud[0]:"down"===t?o.ud[1]:"forward"===t?o.fb[0]:"backward"===t?o.fb[1]:"parent"===t?o.pc[0]:"child"===t?o.pc[1]:null;console.log("currentFocus",e.currentFocus),console.log("direction",t),console.log("d",o),console.log("target",n),n&&e.prepNode(n,e.currentFocus)}},e.move.left=()=>{e.move.inDirection("left")},e.move.right=()=>{e.move.inDirection("right")},e.move.up=()=>{e.move.inDirection("up")},e.move.down=()=>{e.move.inDirection("down")},e.move.forward=()=>{e.move.inDirection("forward")},e.move.backward=()=>{e.move.inDirection("backward")},e.move.toParent=()=>{e.move.inDirection("parent")},e.move.toFirstChild=()=>{e.move.inDirection("child")},e.currentFocus=null,e.currentOptions=null,e.handleKeydownInteraction=t=>{console.log("key down",t);const o=e.keyBindings[t.code];o&&(t.preventDefault(),e.move.inDirection(o))},e.handleFocusInteraction=e=>{console.log("focus",e)},e.select=()=>{},e.escape=()=>{},e.undo=()=>{},e.redo=()=>{},e.keyBindings={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Period:"forward",Comma:"backward",Escape:"parent",Enter:"child"},window.dn=e;const t={category:"abc",group:"xyz",series:"ijk",level:"012"};let o={};const n={omitKeyNames:!1};document.querySelectorAll("rect").forEach((r=>{if(r.id.includes("ref-")){const i=r.id.substring(4);console.log(i);const s={category:i.substring(0,1),group:i.substring(1,2),series:i.substring(2,3),level:i.substring(3,4),id:r.id},d=e=>document.getElementById(`ref-${e}`);console.log(t.series.indexOf(s.series-1)),console.log(i.replace(s.series,t.series.substring(t.series.indexOf(s.series-1),t.series.indexOf(s.series-1)+1)));const c=(e,o)=>{const n=t[e].indexOf(s[e]);let r="";if(n+o>-1&&n+o<3){const d=t[e].substring(n+o,n+o+1);r=i.replace(s[e],d)}return d(r)?r:""},a=c("series",-1),l=c("series",1),u=c("category",-1),g=c("category",1),b=c("group",-1),m=c("group",1),p="byj1"===i||"byj2"===i?c("level",-1):"",y="byj1"===i||"byj0"===i?c("level",1):"";o[i]={d:s,x:+r.getAttribute("x")-2,y:+r.getAttribute("y")-2,width:+r.getAttribute("width"),height:+r.getAttribute("height"),ref:"ref-"+i,id:i,cssClass:"dn-test-class",lr:[a,l],ud:[u,g],fb:[b,m],pc:[p,y],description:e.describe(s,n),semantics:"node"},console.log(o[i])}})),console.log("dataUsedInChart",o),console.log("keys",Object.keys(o));let r={data:o,firstNode:"byj1",id:"data-navigator-schema",rendering:"full",style:"width: 100%,",manualEventHandling:!1},i=e.build(r);document.getElementById("root").appendChild(i)})();