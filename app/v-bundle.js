(()=>{"use strict";var e={312:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NodeElementDefaults=i.GenericLimitedNavigationRules=i.GenericFullNavigationPairs=i.GenericFullNavigationDimensions=i.GenericFullNavigationRules=i.TypicallyUnreservedKeyPairs=i.TypicallyUnreservedSoloKeys=i.TypicallyUnreservedKeys=i.defaultKeyBindings=i.SemanticKeys=void 0,i.SemanticKeys={Escape:!0,Enter:!0,Backspace:!0,ArrowLeft:!0,ArrowRight:!0,ArrowUp:!0,ArrowDown:!0},i.defaultKeyBindings={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Period:"forward",Comma:"backward",Escape:"parent",Enter:"child"},i.TypicallyUnreservedKeys=["KeyW","KeyJ","LeftBracket","RightBracket","Slash","Backslash"],i.TypicallyUnreservedSoloKeys=["KeyW","KeyJ"],i.TypicallyUnreservedKeyPairs=[["LeftBracket","RightBracket"],["Slash","Backslash"]],i.GenericFullNavigationRules={left:{key:"ArrowLeft",direction:"source"},right:{key:"ArrowRight",direction:"target"},up:{key:"ArrowUp",direction:"source"},down:{key:"ArrowDown",direction:"target"},child:{key:"Enter",direction:"target"},parent:{key:"Backspace",direction:"source"},backward:{key:"Comma",direction:"source"},forward:{key:"Period",direction:"target"},previous:{key:"Semicolon",direction:"source"},next:{key:"Quote",direction:"target"},exit:{key:"Escape",direction:"target"},help:{key:"KeyY",direction:"target"},undo:{key:"KeyZ",direction:"target"}},i.GenericFullNavigationDimensions=[["left","right"],["up","down"],["backward","forward"],["previous","next"]],i.GenericFullNavigationPairs={left:["left","right"],right:["left","right"],up:["up","down"],down:["up","down"],backward:["backward","forward"],forward:["backward","forward"],previous:["previous","next"],next:["previous","next"],parent:["parent","child"],child:["parent","child"],exit:["exit","undo"],undo:["undo","undo"]},i.GenericLimitedNavigationRules={right:{key:"ArrowRight",direction:"target"},left:{key:"ArrowLeft",direction:"source"},down:{key:"ArrowDown",direction:"target"},up:{key:"ArrowUp",direction:"source"},child:{key:"Enter",direction:"target"},parent:{key:"Backspace",direction:"source"},exit:{key:"Escape",direction:"target"},undo:{key:"Period",direction:"target"},legend:{key:"KeyL",direction:"target"}},i.NodeElementDefaults={cssClass:"",spatialProperties:{x:0,y:0,width:0,height:0,path:""},semantics:{label:"",elementType:"div",role:"image",attributes:void 0},parentSemantics:{label:"",elementType:"figure",role:"figure",attributes:void 0},existingElement:{useForSpatialProperties:!1,spatialProperties:void 0}}},607:(e,i,t)=>{var n=t(4),o=t(489),r=t(992);i.Z={structure:n.default,input:o.default,rendering:r.default}},489:(e,i,t)=>{Object.defineProperty(i,"__esModule",{value:!0});var n=t(312);i.default=function(e){var i={},t=n.defaultKeyBindings,o=n.GenericFullNavigationRules;return i.moveTo=function(i){var t=e.structure.nodes[i];if(t)return t},i.move=function(t,n){if(t){var r=e.structure.nodes[t];if(r.edges){var s=null,a=0,d=o[n];if(!d)return;var l=function(){var i=e.structure.edges[r.edges[a]];if(i.navigationRules.forEach((function(e){s||(s=function(e,i){if(e!==n)return null;var o={target:"string"==typeof i.target?i.target:i.target(r,t),source:"string"==typeof i.source?i.source:i.source(r,t)};return o[d.direction]!==t?o[d.direction]:null}(e,i))})),s)return"break"};for(a=0;a<r.edges.length&&"break"!==l();a++);return s?i.moveTo(s):void 0}}},i.enter=function(){return e.entryPoint?i.moveTo(e.entryPoint):void console.error("No entry point was specified in InputOptions, returning undefined")},i.exit=function(){return e.exitPoint?e.exitPoint:void console.error("No exit point was specified in InputOptions, returning undefined")},i.keydownValidator=function(e){var i=t[e.code];if(i)return i},i.focus=function(e){var i=document.getElementById(e);i&&i.focus()},i.setNavigationKeyBindings=function(e){e?(t={},o=e,Object.keys(e).forEach((function(i){var n=e[i];t[n.key]=i}))):(t=n.defaultKeyBindings,o=n.GenericFullNavigationRules)},i.setNavigationKeyBindings(e.navigationRules),i}},992:function(e,i,t){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var i,t=1,n=arguments.length;t<n;t++)for(var o in i=arguments[t])Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArray||function(e,i,t){if(t||2===arguments.length)for(var n,o=0,r=i.length;o<r;o++)!n&&o in i||(n||(n=Array.prototype.slice.call(i,0,o)),n[o]=i[o]);return e.concat(n||Array.prototype.slice.call(i))};Object.defineProperty(i,"__esModule",{value:!0});var r=t(312);i.default=function(e){var i=function(e){s.wrapper.setAttribute("aria-activedescendant",e.srcElement.id)},t=function(){s.wrapper.setAttribute("aria-activedescendant","")},s={},a=!1,d={cssClass:r.NodeElementDefaults.cssClass,spatialProperties:n({},r.NodeElementDefaults.spatialProperties),semantics:n({},r.NodeElementDefaults.semantics),parentSemantics:n({},r.NodeElementDefaults.parentSemantics),existingElement:n({},r.NodeElementDefaults.existingElement)};return e.defaults&&(d.cssClass=e.defaults.cssClass||d.cssClass,d.spatialProperties=e.defaults.spatialProperties?n(n({},d.spatialProperties),e.defaults.spatialProperties):d.spatialProperties,d.semantics=e.defaults.semantics?n(n({},d.semantics),e.defaults.semantics):d.semantics,d.parentSemantics=e.defaults.parentSemantics?n(n({},d.parentSemantics),e.defaults.parentSemantics):d.parentSemantics,d.existingElement=e.defaults.existingElement?n(n({},d.existingElement),e.defaults.existingElement):d.existingElement),s.initialize=function(){var i;if(a)console.error("The renderer wrapper has already been initialized successfully, RenderingOptions.suffixId is: ".concat(e.suffixId,". No further action was taken."));else if(e.root&&document.getElementById(e.root.id)){if(s.root=document.getElementById(e.root.id),s.root.style.position="relative",s.root.classList.add("dn-root"),e.suffixId)return s.wrapper=document.createElement("div"),s.wrapper.id="dn-wrapper-"+e.suffixId,s.wrapper.setAttribute("role","application"),s.wrapper.setAttribute("aria-label",e.root.description||"Data navigation structure"),s.wrapper.setAttribute("aria-activedescendant",""),s.wrapper.classList.add("dn-wrapper"),s.wrapper.style.width=e.root&&e.root.width?e.root.width:"100%",e.root&&e.root.height&&(s.wrapper.style.height=e.root.height),e.entryButton&&e.entryButton.include&&(s.entryButton=document.createElement("button"),s.entryButton.id="dn-entry-button-"+e.suffixId,s.entryButton.classList.add("dn-entry-button"),s.entryButton.innerText="Enter navigation area",e.entryButton.callbacks&&e.entryButton.callbacks.click&&s.entryButton.addEventListener("click",e.entryButton.callbacks.click),e.entryButton.callbacks&&e.entryButton.callbacks.focus&&s.entryButton.addEventListener("focus",e.entryButton.callbacks.focus),s.wrapper.appendChild(s.entryButton)),s.root.appendChild(s.wrapper),(null===(i=e.exitElement)||void 0===i?void 0:i.include)&&(s.exitElement=document.createElement("div"),s.exitElement.id="dn-exit-"+e.suffixId,s.exitElement.classList.add("dn-exit-position"),s.exitElement.innerText="End of data structure.",s.exitElement.setAttribute("aria-label","End of data structure."),s.exitElement.setAttribute("role","note"),s.exitElement.setAttribute("tabindex","-1"),s.exitElement.style.display="none",s.exitElement.addEventListener("focus",(function(i){var t,n;s.exitElement.style.display="block",s.clearStructure(),(null===(n=null===(t=e.exitElement)||void 0===t?void 0:t.callbacks)||void 0===n?void 0:n.focus)&&e.exitElement.callbacks.focus(i)})),s.exitElement.addEventListener("blur",(function(i){var t,n;s.exitElement.style.display="none",(null===(n=null===(t=e.exitElement)||void 0===t?void 0:t.callbacks)||void 0===n?void 0:n.blur)&&e.exitElement.callbacks.blur(i)})),s.root.appendChild(s.exitElement)),a=!0,s.root;console.error("No suffix id found: options.suffixId must be specified.")}else console.error("No root element found, cannot build: RenderingOptions.root.id must reference an existing DOM element in order to render children.")},s.render=function(n){var o=n.renderId+"",r=e.elementData[o];if(r){if(a){var l=!1,u={},c=function(e,i,t){var o=r[e]||d[e],s=t&&l?u[i]:o[i],a=d[e][i];return"function"==typeof o?o(r,n.datum):"function"==typeof s?s(r,n.datum):s||a||(i?void 0:o)};l=c("existingElement","useForSpatialProperties"),u=c("existingElement","spatialProperties");var v=parseFloat(c("spatialProperties","width",!0)||0),p=parseFloat(c("spatialProperties","height",!0)||0),g=parseFloat(c("spatialProperties","x",!0)||0),f=parseFloat(c("spatialProperties","y",!0)||0),y=document.createElement(c("parentSemantics","elementType")),m=c("parentSemantics","attributes");"object"==typeof m&&Object.keys(m).forEach((function(e){y.setAttribute(e,m[e])})),y.setAttribute("role",c("parentSemantics","role")),y.id=o,y.classList.add("dn-node"),y.classList.add(c("cssClass")),y.style.width=v+"px",y.style.height=p+"px",y.style.left=g+"px",y.style.top=f+"px",y.setAttribute("tabindex","0"),y.addEventListener("focus",i),y.addEventListener("blur",t);var h=document.createElement(c("semantics","elementType")),b=c("semantics","attributes");"object"==typeof b&&Object.keys(b).forEach((function(e){y.setAttribute(e,b[e])})),h.setAttribute("role",c("semantics","role")),h.classList.add("dn-node-text"),r.showText&&(h.innerText=r.semantics.label);var E=c("semantics","label");E||console.error("Accessibility error: a label must be supplied to every rendered element using semantics.label."),h.setAttribute("aria-label",E),y.appendChild(h);var k=c("spatialProperties","path");if(k){var x=v+g+10,w=p+f+10,K=document.createElementNS("http://www.w3.org/2000/svg","svg");K.setAttribute("width",x+""),K.setAttribute("height",w+""),K.setAttribute("viewBox","0 0 ".concat(x," ").concat(w)),K.style.left=-g+"px",K.style.top=-f+"px",K.classList.add("dn-node-svg"),K.setAttribute("role","presentation"),K.setAttribute("focusable","false");var I=document.createElementNS("http://www.w3.org/2000/svg","path");I.setAttribute("d",k),I.classList.add("dn-node-path"),K.appendChild(I),y.appendChild(K)}return s.wrapper.appendChild(y),y}console.error("render() was called before initialize(), renderer must be initialized first.")}else console.warn("Render data not found with renderId: ".concat(o,". Failed to render."))},s.remove=function(e){var n=document.getElementById(e);s.wrapper.getAttribute("aria-activedescendant")===e&&s.wrapper.setAttribute("aria-activedescendant",""),n&&(n.removeEventListener("focus",i),n.removeEventListener("blur",t),n.remove())},s.clearStructure=function(){o([],s.wrapper.children,!0).forEach((function(e){s.entryButton&&s.entryButton===e||s.remove(e.id)}))},s}},4:function(e,i,t){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var i,t=1,n=arguments.length;t<n;t++)for(var o in i=arguments[t])Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArray||function(e,i,t){if(t||2===arguments.length)for(var n,o=0,r=i.length;o<r;o++)!n&&o in i||(n||(n=Array.prototype.slice.call(i,0,o)),n[o]=i[o]);return e.concat(n||Array.prototype.slice.call(i))};Object.defineProperty(i,"__esModule",{value:!0}),i.buildStructure=i.buildRules=i.buildEdges=i.scaffoldDimensions=i.buildNodes=i.addSimpleDataIDs=i.buildNodeStructureFromVegaLite=void 0;var r=t(312),s=t(5);i.default=function(e){return"vega-lite"===e.dataType||"vl"===e.dataType||"Vega-Lite"===e.dataType?(0,i.buildNodeStructureFromVegaLite)(e):(0,i.buildStructure)(e)},i.buildNodeStructureFromVegaLite=function(e){var i=r.GenericLimitedNavigationRules,t={},n={},o={},a=0,d=e.groupInclusionCriteria?e.groupInclusionCriteria:function(){return!0},l=e.itemInclusionCriteria?e.itemInclusionCriteria:function(){return!0},u=e.datumInclusionCriteria?e.datumInclusionCriteria:function(){return!0},c=e.vegaLiteView._renderer._origin,v=e.vegaLiteView._scenegraph.root.items[0].mark.items[0],p=function(e,i){if(e["data-navigator-id"])return e["data-navigator-id"];var t="dn-node-".concat(i,"-").concat(a);return a++,e["data-navigator-id"]=t,t},g=function(i,n,r,a,d){var l=p(i,n),c="render-"+l,v=r||[0,0];t[l]={},t[l].d={},t[l].id=l,t[l].renderId=c,t[l].index=a,t[l].level=n,t[l].parent=d,o[c]={},o[c].renderId=c,o[c].spatialProperties={},o[c].spatialProperties.x=i.bounds.x1+v[0],o[c].spatialProperties.y=i.bounds.y1+v[1],o[c].spatialProperties.width=i.bounds.x2-i.bounds.x1,o[c].spatialProperties.height=i.bounds.y2-i.bounds.y1,o[c].cssClass="dn-vega-lite-node",i.datum&&Object.keys(i.datum).forEach((function(o){var r=i.datum[o];u(o,r,i.datum,n,e.vegaLiteSpec)&&(t[l].d[e.keyRenamingHash&&e.keyRenamingHash[o]?e.keyRenamingHash[o]:o]=r)})),o[c].semantics={},o[c].semantics.label=e.nodeDescriber?e.nodeDescriber(t[l].d,i,n):(0,s.describeNode)(t[l].d)},f=0;return v.items.forEach((function(i){if(d(i,f,e.vegaLiteSpec)){g(i,"group",c,f,v);var t=0,n=i.items[0].mark.items[0].items?i.items[0].mark.items[0]:i;n.items.forEach((function(o){l(o,t,i,e.vegaLiteSpec)&&g(o,"item",c,t,n),t++}))}f++})),Object.keys(t).forEach((function(i){t[i].edges=function(i){var o=t[i],r=o.index,s=o.level,a=o.parent,d=[],l=a.items[r-1];if(l){var u=p(l,s);if(t[u]){var c="".concat(u,"-").concat(o.id);d.push(c),n[c]||(n[c]={source:u,target:o.id,navigationRules:["left","right"]})}}var v=a.items[r+1];if(v){var g=p(v,s);if(t[g]){var f="".concat(o.id,"-").concat(g);d.push(f),n[f]||(n[f]={source:o.id,target:g,navigationRules:["left","right"]})}}if("group"===s&&a.items[r].items){var y=(a.items[r].items[0].mark.items[0].items||a.items[r].items)[0],m=p(y,"item");if(t[m]){var h="".concat(o.id,"-").concat(m);d.push(h),n[h]||(n[h]={source:o.id,target:m,navigationRules:["parent","child"]})}}else if("item"===s){var b=p(a,"group");if(t[b]){var E="".concat(b,"-").concat(o.id);d.push(E),n[E]||(n[E]={source:b,target:o.id,navigationRules:["parent","child"]})}}return e.exitFunction&&(d.push("any-exit"),n["any-exit"]||(n["any-exit"]={source:e.getCurrent,target:e.exitFunction,navigationRules:["exit"]})),d.push("any-undo"),n["any-undo"]||(n["any-undo"]={source:e.getCurrent,target:e.getPrevious,navigationRules:["undo"]}),d}(i)})),{nodes:t,edges:n,elementData:o,navigationRules:i}},i.addSimpleDataIDs=function(e){var i=0,t={};e.data.forEach((function(n){var o="function"==typeof e.idKey?e.idKey(n):e.idKey;n[o]="_"+i,e.keysForIdGeneration&&e.keysForIdGeneration.forEach((function(e){e in n&&("string"==typeof n[e]?(t[e]||(t[e]=0),t[n[e]]||(t[n[e]]=0),n[o]+="_"+e+t[e]+"_"+n[e]+t[n[e]],t[e]++,t[n[e]]++):(t[e]||(t[e]=0),n[o]+="_"+e+t[e],t[e]++))})),i++}))},i.buildNodes=function(e){var i={};return e.data.forEach((function(t){e.idKey||console.error("Building nodes. A key string must be supplied in options.idKey to specify the id keys of every node.");var n="function"==typeof e.idKey?e.idKey(t):e.idKey,o=t[n];if(o)if(i[o])console.error("Building nodes. Each id for data in options.data must be unique. This id is not unique: ".concat(o,"."));else{var r="function"==typeof e.renderIdKey?e.renderIdKey(t):e.renderIdKey;i[o]={id:o,edges:[],renderId:r?t[r]||"":t.renderIdKey||"",data:t}}else console.error("Building nodes. Each datum in options.data must contain an id. When matching the id key string ".concat(n,", this datum has no id: ").concat(JSON.stringify(t),"."))})),i},i.scaffoldDimensions=function(e,i){var t,a,d={};if(null===(a=null===(t=e.dimensions)||void 0===t?void 0:t.parentOptions)||void 0===a?void 0:a.addLevel0){var l=e.dimensions.parentOptions.addLevel0;i[l.id]=n(n({},l),{dimensionLevel:0})}var u=o([],r.GenericFullNavigationDimensions,!0);return e.data.forEach((function(t){var r=e.dimensions.values||[],a=0;r.forEach((function(r){var l,c,v,p,g,f,y,m;if(r.dimensionKey){if(r.dimensionKey in t){var h=t[r.dimensionKey],b="function"!=typeof(null===(l=r.operations)||void 0===l?void 0:l.filterFunction)||r.operations.filterFunction(t,r);if(void 0!==h&&b){if(r.type||(r.type="bigint"==typeof h||"number"==typeof h?"numerical":"categorical"),!d[r.dimensionKey]){var E="function"==typeof r.nodeId?r.nodeId(r,e.data):r.nodeId||(0,s.createValidId)(r.dimensionKey),k="function"==typeof r.renderId?r.renderId(r,e.data):r.renderId||E;d[r.dimensionKey]={dimensionKey:r.dimensionKey,nodeId:E,divisions:{},numericalExtents:[1/0,-1/0],type:r.type,operations:{compressSparseDivisions:(null===(c=r.operations)||void 0===c?void 0:c.compressSparseDivisions)||!1,sortFunction:(null===(v=r.operations)||void 0===v?void 0:v.sortFunction)||void 0},behavior:r.behavior||{extents:"circular"},navigationRules:r.navigationRules||{sibling_sibling:u.length?o([],u.shift(),!0):["previous_"+r.dimensionKey,"next_"+r.dimensionKey],parent_child:["parent_"+r.dimensionKey,"child"]}},i[E]={id:E,renderId:k,derivedNode:r.dimensionKey,edges:[],dimensionLevel:1,data:d[r.dimensionKey],renderingStrategy:r.renderingStrategy||"singleSquare"}}var x=d[r.dimensionKey],w=null;if("categorical"===r.type){var K="function"==typeof(null===(p=r.divisionOptions)||void 0===p?void 0:p.divisionNodeIds)?r.divisionOptions.divisionNodeIds(r.dimensionKey,h,a):(0,s.createValidId)(x.nodeId+"_"+h);if(!(w=x.divisions[K])){w=x.divisions[K]={id:K,sortFunction:(null===(g=r.divisionOptions)||void 0===g?void 0:g.sortFunction)||void 0,values:{}};var I="function"==typeof(null===(f=r.divisionOptions)||void 0===f?void 0:f.divisionRenderIds)?r.divisionOptions.divisionRenderIds(r.dimensionKey,h,a):K;i[K]={id:K,renderId:I,derivedNode:r.dimensionKey,edges:[],dimensionLevel:2,data:n({},w),renderingStrategy:(null===(y=r.divisionOptions)||void 0===y?void 0:y.renderingStrategy)||"singleSquare"},i[K].data[r.dimensionKey]=h}}else{(w=x.divisions[x.nodeId])||(w=x.divisions[x.nodeId]={id:x.nodeId,sortFunction:(null===(m=r.divisionOptions)||void 0===m?void 0:m.sortFunction)||void 0,values:{}}),r.operations||(r.operations={});var O=r.operations.createNumericalSubdivisions;x.subdivisions="number"==typeof O&&O<1?1:O||1,1!==O&&(x.divisionOptions||(x.divisionOptions=r.divisionOptions),function(e,i){var t=i.numericalExtents[0],n=i.numericalExtents[1];i.numericalExtents[0]=t<e?t:e,i.numericalExtents[1]=n>e?n:e}(h,x))}var R="function"==typeof e.idKey?e.idKey(t):e.idKey;w.values[t[R]]=t}}a++}else console.error("Building nodes, parsing dimensions. Each dimension in options.dimensions must contain a dimensionKey. This dimension has no key: ".concat(JSON.stringify(r),"."))}))})),Object.keys(d).forEach((function(e){var t,n,o,r,s,a=d[e],l=a.divisions;if("numerical"===a.type){l[a.nodeId].values=Object.fromEntries(Object.entries(l[a.nodeId].values).sort((function(i,t){var n;return"function"==typeof(null===(n=a.operations)||void 0===n?void 0:n.sortFunction)?a.operations.sortFunction(i[1],t[1],a):i[1][e]-t[1][e]})));var u=l[a.nodeId].values;if(a.numericalExtents[0]!==1/0&&1!==a.subdivisions){var c=Object.keys(u),v="function"==typeof a.subdivisions?a.subdivisions(e,u):a.subdivisions,p=(a.numericalExtents[1]-a.numericalExtents[0])/v,g=a.numericalExtents[0]+p,f=0;for(g=a.numericalExtents[0]+p;g<=a.numericalExtents[1];g+=p){var y="function"==typeof(null===(t=a.divisionOptions)||void 0===t?void 0:t.divisionNodeIds)?a.divisionOptions.divisionNodeIds(e,g,g):a.nodeId+"_"+g;a.divisions[y]={id:y,sortFunction:(null===(n=a.divisionOptions)||void 0===n?void 0:n.sortFunction)||void 0,values:{}};var m="function"==typeof(null===(o=a.divisionOptions)||void 0===o?void 0:o.divisionRenderIds)?a.divisionOptions.divisionRenderIds(e,g,g):y;i[y]={id:y,renderId:m,derivedNode:e,edges:[],data:a.divisions[y],dimensionLevel:2,renderingStrategy:(null===(r=a.divisionOptions)||void 0===r?void 0:r.renderingStrategy)||"singleSquare"};for(var h=!1;!h&&f<c.length;){var b=u[c[f]];b[e]<=g?a.divisions[y].values[b.id]=b:(g+=p,h=!0),f++}}delete l[e]}}else"function"==typeof(null===(s=a.operations)||void 0===s?void 0:s.sortFunction)&&(a.divisions=Object.fromEntries(Object.entries(l).sort((function(e,i){return a.operations.sortFunction(e[1],i[1],a)}))));Object.keys(a.divisions).forEach((function(e){var i=a.divisions[e];"function"==typeof i.sortFunction&&(i.values=Object.fromEntries(Object.entries(i.values).sort((function(e,t){return i.sortFunction(e[1],t[1],i)}))))}))})),Object.keys(d).forEach((function(e){var t=d[e];if(t.operations.compressSparseDivisions){var o=Object.keys(t.divisions),r={},s=!0;if(o.forEach((function(e){var i=t.divisions[e],o=Object.keys(i.values);o.length<=1?o.forEach((function(e){r[e]=n({},i.values[e])})):s=!1})),s){var a={id:t.nodeId,values:r};o.forEach((function(e){delete i[e]})),t.divisions={},t.divisions[t.nodeId]=a}}})),e.dimensions.adjustDimensions&&(d=e.dimensions.adjustDimensions(d)),d},i.buildEdges=function(e,i,t){var n,r,s,a,d,l,u,c,v,p,g={},f=function(e,t){-1===i[e].edges.indexOf(t)&&i[e].edges.push(t)},y=function(i,t,n,r){var s="".concat(i,"-").concat(t),a=e.useDirectedEdges?"".concat(t,"-").concat(s):s,d=!r||"source"===r,l=!r||"target"===r,u=function(e){var r;g[e]?(r=g[e].navigationRules).push.apply(r,n||[]):g[e]={source:i,target:t,navigationRules:n?o([],n,!0):[]}};u(s),e.useDirectedEdges&&l&&u(a),d&&f(i,s),l&&f(t,a)};if(t&&Object.keys(t).length){var m=Object.keys(t),h=null===(s=null===(r=null===(n=e.dimensions)||void 0===n?void 0:n.parentOptions)||void 0===r?void 0:r.level1Options)||void 0===s?void 0:s.order,b=h||m,E=0,k=(null===(a=e.dimensions)||void 0===a?void 0:a.parentOptions)||{},x=(null===(l=null===(d=k.level1Options)||void 0===d?void 0:d.behavior)||void 0===l?void 0:l.extents)||"terminal",w=k.addLevel0,K=w?(null===(c=null===(u=k.level1Options)||void 0===u?void 0:u.navigationRules)||void 0===c?void 0:c.parent_child)||["parent","child"]:[],I=(null===(p=null===(v=k.level1Options)||void 0===v?void 0:v.navigationRules)||void 0===p?void 0:p.sibling_sibling)||["left","right"],O="string"==typeof b[0]?h?i[b[0]]:i[t[b[0]].nodeId]:b[0];w&&y(w.id,O.id,K,"source"),b.forEach((function(n){var o="string"==typeof n?h?i[n]:i[t[n].nodeId]:n;if(o!==n||i[o.id]||(i[o.id]=o),w&&(e.useDirectedEdges?y(o.id,w.id,K,"source"):y(w.id,o.id,K,"target")),E===b.length-1&&"circular"===x)y(o.id,O.id,I);else if(E===b.length-1&&"bridgedCustom"===x)y(o.id,k.level1Options.behavior.customBridgePost,I);else if(E<b.length-1){var r="string"==typeof b[E+1]?h?i[b[E+1]]:i[t[b[E+1]].nodeId]:b[E+1];y(o.id,r.id,I)}E||"bridgedCustom"!==x||y(k.level1Options.behavior.customBridgePost,o.id,I),E++})),m.forEach((function(i){var n,o,r,s,a=t[i],d=(null===(n=a.behavior)||void 0===n?void 0:n.childmostNavigation)||"within",l="across"===d&&(null===(o=a.behavior)||void 0===o?void 0:o.childmostMatching)?null===(r=a.behavior)||void 0===r?void 0:r.childmostMatching:function(e,i,t,n){return n.values[Object.keys(n.values)[e]]||void 0},u=(null===(s=a.behavior)||void 0===s?void 0:s.extents)||"circular";a.divisions||console.error("Parsing dimensions. The dimension using the key ".concat(i," is missing the divisions property. dimension.divisions should be supplied. ").concat(JSON.stringify(a),"."));var c=Object.keys(a.divisions),v=a.divisions[c[0]];if(1!==c.length)y(a.nodeId,v.id,a.navigationRules.parent_child,"source");else{var p=Object.keys(v.values),g="function"==typeof e.idKey?e.idKey(v.values[p[0]]):e.idKey;y(a.nodeId,v.values[p[0]][g],a.navigationRules.parent_child,"source")}var f=0;c.forEach((function(i){var t=a.divisions[i];f!==c.length-1||"circular"!==u&&"bridgedCousins"!==u&&"bridgedCustom"!==u?f<c.length-1&&y(t.id,a.divisions[c[f+1]].id,a.navigationRules.sibling_sibling):y(t.id,a.divisions[c[0]].id,a.navigationRules.sibling_sibling);var n=Object.keys(t.values);e.useDirectedEdges?y(t.id,a.nodeId,a.navigationRules.parent_child,"source"):y(a.nodeId,t.id,a.navigationRules.parent_child,"target");var o="function"==typeof e.idKey?e.idKey(t.values[n[0]]):e.idKey;y(t.id,t.values[n[0]][o],a.navigationRules.parent_child,"source");var r=0;n.length>1&&n.forEach((function(i){var o=t.values[i],s="function"==typeof e.idKey?e.idKey(o):e.idKey,v=1!==c.length?t.id:a.nodeId;if(e.useDirectedEdges?y(o[s],v,a.navigationRules.parent_child,"source"):y(v,o[s],a.navigationRules.parent_child,"target"),"within"===d){if(r===n.length-1&&"circular"===u){var p="function"==typeof e.idKey?e.idKey(t.values[n[0]]):e.idKey;y(o[s],t.values[n[0]][p],a.navigationRules.sibling_sibling)}else r===n.length-1&&"bridgedCousins"===u?f!==c.length-1?(p="function"==typeof e.idKey?e.idKey(a.divisions[c[f+1]].values[n[0]]):e.idKey,y(o[s],a.divisions[c[f+1]].values[n[0]][p],a.navigationRules.sibling_sibling)):(p="function"==typeof e.idKey?e.idKey(a.divisions[c[0]].values[n[0]]):e.idKey,y(o[s],a.divisions[c[0]].values[n[0]][p],a.navigationRules.sibling_sibling)):r===n.length-1&&"bridgedCustom"===u?y(o[s],a.behavior.customBridgePost,a.navigationRules.sibling_sibling):r<n.length-1&&(p="function"==typeof e.idKey?e.idKey(t.values[n[r+1]]):e.idKey,y(o[s],t.values[n[r+1]][p],a.navigationRules.sibling_sibling));r||"bridgedCousins"!==u?r||"bridgedCustom"!==u||y(a.behavior.customBridgePrevious,o[s],a.navigationRules.sibling_sibling):0!==f?(p="function"==typeof e.idKey?e.idKey(a.divisions[c[f-1]].values[n[n.length-1]]):e.idKey,y(a.divisions[c[f-1]].values[n[n.length-1]][p],o[s],a.navigationRules.sibling_sibling)):(p="function"==typeof e.idKey?e.idKey(a.divisions[c[c.length-1]].values[n[n.length-1]]):e.idKey,y(a.divisions[c[c.length-1]].values[n[n.length-1]][p],o[s],a.navigationRules.sibling_sibling))}else if(f===c.length-1&&"bridgedCustom"===u)y(o[s],a.behavior.customBridgePost,a.navigationRules.sibling_sibling);else if(f||"bridgedCustom"!==u){var g=f===c.length-1&&"circular"===u?a.divisions[c[0]]:a.divisions[c[f+1]];if(g){var m=l(r,o[s],t,g);m&&(p="function"==typeof e.idKey?e.idKey(m):e.idKey,y(o[s],m[p],a.navigationRules.sibling_sibling))}}else y(a.behavior.customBridgePrevious,o[s],a.navigationRules.sibling_sibling);r++})),f++}))}))}return Object.keys(i).forEach((function(t){var n,o=i[t];(null===(n=e.genericEdges)||void 0===n?void 0:n.length)&&e.genericEdges.forEach((function(e){g[e.edgeId]||(g[e.edgeId]=e.edge),(!e.conditional||e.conditional&&e.conditional(o,e))&&o.edges.push(e.edgeId)}))})),g},i.buildRules=function(e,i,t){var s,a,d,l,u=e.navigationRules;if(!u){var c=Object.keys(t||{});c.length>6&&console.error("Building navigationRules. Dimension count is too high to automatically generate key commands. It is recommend you reduce your dimensions to 6 or fewer for end-user experience. If not, you must provide your own navigation rules in options.navigationRules. Details: Count is ".concat(c.length,". Dimensions counted: ").concat(c.join(", "),"."));var v={},p={},g={},f=o([],r.TypicallyUnreservedKeyPairs,!0),y=o([],r.TypicallyUnreservedKeys,!0),m=function(i,t){var r=i&&t,s=!1,a=!1;if((v[i]||p[i])&&(p[i]=n({},v[i]),s=!0),t&&(v[t]||p[t])&&(p[t]=n({},v[t]),a=!0),!r||s||a){if(!p[i]&&y.length){var d=y.shift(),l=[];f.forEach((function(e){d!==e[0]&&d!==e[1]&&l.push(e)})),f=l,p[i]={direction:e.useDirectedEdges?"target":"source",key:d}}if(t&&!p[t]&&y.length){var u=y.shift(),c=[];f.forEach((function(e){u!==e[0]&&u!==e[1]&&c.push(e)})),f=c,p[t]={direction:"target",key:u}}y.length||(p[i]||(g[i]=i),t&&!p[t]&&(g[t]=t))}else{f.length||console.error("Building navigationRules. Dimension count is too high to automatically generate key commands, we have run out of keyboard key pairs to assign. You must either provide your own navigation rules in options.navigationRules, provide rules when generating dimensions, or reduce dimension count.");var m=o([],f.shift(),!0);y.splice(y.indexOf(m[0]),1),y.splice(y.indexOf(m[1]),1),p[i]={direction:e.useDirectedEdges?"target":"source",key:m[0]},p[t]={direction:"target",key:m[1]}}};if(Object.keys(r.GenericFullNavigationRules).forEach((function(i){var t=n({},r.GenericFullNavigationRules[i]);e.useDirectedEdges&&(t.direction="target"),v[i]=t})),c.length){if(null===(a=null===(s=e.dimensions)||void 0===s?void 0:s.parentOptions)||void 0===a?void 0:a.addLevel0){var h=(null===(l=null===(d=e.dimensions.parentOptions.level1Options)||void 0===d?void 0:d.navigationRules)||void 0===l?void 0:l.parent_child)||["parent","child"];m(h[0],h[1])}c.forEach((function(e){var i=t[e].navigationRules.parent_child,n=t[e].navigationRules.sibling_sibling;m(i[0],i[1]),m(n[0],n[1])}))}if(Object.keys(i).forEach((function(e){i[e].navigationRules.forEach((function(e){p[e]||m(e)}))})),Object.keys(g).length){var b={};Object.keys(p).forEach((function(e){b[p[e].key]=p[e].key})),Object.keys(v).forEach((function(e){b[v[e].key]||r.SemanticKeys[v[e].key]||y.push(v[e].key)}));var E=n({},g);g={},Object.keys(E).forEach((function(e){m(e)})),Object.keys(g).length&&console.error("Building navigationRules. There are no more keys left to assign automatically. Recommended fixes: use fewer dimensions, use fewer GenericEdges, or build your own navigationRules. Rules remaining without keyboard keys: ".concat(Object.keys(g).join(", "),"."))}u=p}return u},i.buildStructure=function(e){e.addIds&&(0,i.addSimpleDataIDs)(e);var t=(0,i.buildNodes)(e),n=(0,i.scaffoldDimensions)(e,t),o=(0,i.buildEdges)(e,t,n);return{nodes:t,edges:o,dimensions:n,navigationRules:(0,i.buildRules)(e,o,n)}}},5:(e,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createValidId=i.describeNode=void 0,i.describeNode=function(e,i){var t=Object.keys(e),n="";return t.forEach((function(t){n+="".concat(i&&i.omitKeyNames?"":t+": ").concat(e[t],". ")})),n+=i&&i.semanticLabel||"Data point."},i.createValidId=function(e){return"_"+e.replace(/[^a-zA-Z0-9_-]+/g,"_")}}},i={};function t(n){var o=i[n];if(void 0!==o)return o.exports;var r=i[n]={exports:{}};return e[n].call(r.exports,r,r.exports,t),r.exports}(()=>{var e=t(607),i=t(5);let n,o,r,s,a,d;const l=()=>a,u=()=>d,c=(e,i,t)=>e.marktype&&!("text"===e.marktype),v=(e,i,t,n)=>!("axis"===t.role||"legend"===t.role),p=(e,i,t,n,o)=>!0,g=(e,t,n)=>{if(Object.keys(e).length)return(0,i.describeNode)(e,{});if(e.role=t.role,"axis"===t.role){const e=t.items[0].items[0].items;return`${"yscale"===t.items[0].datum.scale?"Y ":"xscale"===t.items[0].datum.scale?"X ":""}Axis. Values range from ${e[0].datum.label} to ${e[e.length-1].datum.label}.`}if("mark"===t.role)return`${t.items.length} navigable data elements. Group. Enter using Enter Key.`;if("legend"===t.role){const e=t.items[0].items[0].items[0].items[0].items;return`Legend: ${o.legends[0].title}. Showing values from ${e[0].items[1].items[0].datum.label} to ${e[e.length-1].items[1].items[0].datum.label}.`}return`${n}.`},f=e=>{const i=r.rendering.render({renderId:e.renderId,datum:e});i.addEventListener("keydown",(e=>{const i=r.input.keydownValidator(e);i&&(e.preventDefault(),y(i))})),i.addEventListener("blur",(()=>{s=!1})),r.input.focus(e.renderId),s=!0,d=a,a=e.id,d&&r.rendering.remove(r.structure.nodes[d].renderId)},y=e=>{const i=r.input.move(a,e);i&&f(i)},m=()=>{s=!1,r.rendering.exitElement.style.display="block",r.input.focus(r.rendering.exitElement.id),d=a,a=null,r.rendering.remove(d)};fetch("https://vega.github.io/vega/examples/scatter-plot.vg.json").then((e=>e.json())).then((e=>(o=e,h(e)))).then((i=>{const t=e.Z.structure({dataType:"vega-lite",vegaLiteView:i,vegaLiteSpec:o,groupInclusionCriteria:c,itemInclusionCriteria:v,datumInclusionCriteria:p,keyRenamingHash:{},nodeDescriber:g,getCurrent:l,getPrevious:u,exitFunction:m}),n=e.Z.rendering({elementData:t.elementData,suffixId:"data-navigator-schema",root:{id:"view",cssClass:"",width:"100%",height:0},entryButton:{include:!0,callbacks:{click:()=>{(()=>{const e=r.input.enter();e&&(s=!0,f(e))})()}}},exitElement:{include:!0}});n.initialize();const a=e.Z.input({structure:{nodes:t.nodes,edges:t.edges},navigationRules:t.navigationRules,entryPoint:Object.keys(t.nodes)[0],exitPoint:n.exitElement.id});return r={structure:t,input:a,rendering:n},r})).catch((e=>console.error(e)));const h=e=>(n=new vega.View(vega.parse(e),{renderer:"canvas",container:"#view",hover:!0}),n.runAsync()),b=new Hammer(document.body,{});b.get("pinch").set({enable:!1}),b.get("rotate").set({enable:!1}),b.get("pan").set({enable:!1}),b.get("swipe").set({direction:Hammer.DIRECTION_ALL,velocity:.2}),b.on("press",(e=>{})),b.on("pressup",(e=>{r.enter()})),b.on("swipe",(e=>{const i=Math.abs(e.deltaX)>Math.abs(e.deltaY)?"X":"Y",t=(Math.abs(e["delta"+i])+1e-9)/(Math.abs(e["delta"+("X"===i?"Y":"X")])+1e-9),n=e.deltaX<0,o=e.deltaX>0,s=e.deltaY<0,a=e.deltaY>0,d=t>.99&&t<=2?o&&s?"forward":o&&a?"child":n&&a?"backward":n&&s?"parent":null:o&&"X"===i?"right":a&&"Y"===i?"down":n&&"X"===i?"left":s&&"Y"===i?"up":null;r.getCurrentFocus()&&d&&r.move(d)}))})()})();