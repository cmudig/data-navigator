(()=>{"use strict";var e={66(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NodeElementDefaults=t.GenericLimitedNavigationRules=t.GenericFullNavigationPairs=t.GenericFullNavigationDimensions=t.GenericFullNavigationRules=t.TypicallyUnreservedKeyPairs=t.TypicallyUnreservedSoloKeys=t.TypicallyUnreservedKeys=t.defaultKeyBindings=t.SemanticKeys=void 0,t.SemanticKeys={Escape:!0,Enter:!0,Backspace:!0,ArrowLeft:!0,ArrowRight:!0,ArrowUp:!0,ArrowDown:!0},t.defaultKeyBindings={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Period:"forward",Comma:"backward",Escape:"parent",Enter:"child"},t.TypicallyUnreservedKeys=["KeyW","KeyJ","LeftBracket","RightBracket","Slash","Backslash"],t.TypicallyUnreservedSoloKeys=["KeyW","KeyJ"],t.TypicallyUnreservedKeyPairs=[["LeftBracket","RightBracket"],["Slash","Backslash"]],t.GenericFullNavigationRules={left:{key:"ArrowLeft",direction:"source"},right:{key:"ArrowRight",direction:"target"},up:{key:"ArrowUp",direction:"source"},down:{key:"ArrowDown",direction:"target"},child:{key:"Enter",direction:"target"},parent:{key:"Backspace",direction:"source"},backward:{key:"Comma",direction:"source"},forward:{key:"Period",direction:"target"},previous:{key:"Semicolon",direction:"source"},next:{key:"Quote",direction:"target"},exit:{key:"Escape",direction:"target"},help:{key:"KeyY",direction:"target"},undo:{key:"KeyZ",direction:"target"}},t.GenericFullNavigationDimensions=[["left","right"],["up","down"],["backward","forward"],["previous","next"]],t.GenericFullNavigationPairs={left:["left","right"],right:["left","right"],up:["up","down"],down:["up","down"],backward:["backward","forward"],forward:["backward","forward"],previous:["previous","next"],next:["previous","next"],parent:["parent","child"],child:["parent","child"],exit:["exit","undo"],undo:["undo","undo"]},t.GenericLimitedNavigationRules={right:{key:"ArrowRight",direction:"target"},left:{key:"ArrowLeft",direction:"source"},down:{key:"ArrowDown",direction:"target"},up:{key:"ArrowUp",direction:"source"},child:{key:"Enter",direction:"target"},parent:{key:"Backspace",direction:"source"},exit:{key:"Escape",direction:"target"},undo:{key:"Period",direction:"target"},legend:{key:"KeyL",direction:"target"}},t.NodeElementDefaults={cssClass:void 0,spatialProperties:{x:0,y:0,width:0,height:0,path:""},semantics:{label:"",elementType:"div",role:"image",attributes:void 0},parentSemantics:{label:"",elementType:"figure",role:"figure",attributes:void 0},existingElement:{useForSpatialProperties:!1,spatialProperties:void 0}}},149(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},n.apply(this,arguments)},a=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.buildStructure=t.buildRules=t.buildEdges=t.scaffoldDimensions=t.buildNodes=t.addSimpleDataIDs=t.buildNodeStructureFromVegaLite=void 0;var o=i(66),s=i(864);t.default=function(e){return"vega-lite"===e.dataType||"vl"===e.dataType||"Vega-Lite"===e.dataType?(0,t.buildNodeStructureFromVegaLite)(e):(0,t.buildStructure)(e)},t.buildNodeStructureFromVegaLite=function(e){var t=o.GenericLimitedNavigationRules,i={},n={},a={},r=0,l=e.groupInclusionCriteria?e.groupInclusionCriteria:function(){return!0},d=e.itemInclusionCriteria?e.itemInclusionCriteria:function(){return!0},c=e.datumInclusionCriteria?e.datumInclusionCriteria:function(){return!0},u=e.vegaLiteView._renderer._origin,p=e.vegaLiteView._scenegraph.root.items[0].mark.items[0],g=function(e,t){if(e["data-navigator-id"])return e["data-navigator-id"];var i="dn-node-".concat(t,"-").concat(r);return r++,e["data-navigator-id"]=i,i},v=function(t,n,o,r,l){var d=g(t,n),u="render-"+d,p=o||[0,0];i[d]={},i[d].d={},i[d].id=d,i[d].renderId=u,i[d].index=r,i[d].level=n,i[d].parent=l,a[u]={},a[u].renderId=u,a[u].spatialProperties={},a[u].spatialProperties.x=t.bounds.x1+p[0],a[u].spatialProperties.y=t.bounds.y1+p[1],a[u].spatialProperties.width=t.bounds.x2-t.bounds.x1,a[u].spatialProperties.height=t.bounds.y2-t.bounds.y1,a[u].cssClass="dn-vega-lite-node",t.datum&&Object.keys(t.datum).forEach(function(a){var o=t.datum[a];c(a,o,t.datum,n,e.vegaLiteSpec)&&(i[d].d[e.keyRenamingHash&&e.keyRenamingHash[a]?e.keyRenamingHash[a]:a]=o)}),a[u].semantics={},a[u].semantics.label=e.nodeDescriber?e.nodeDescriber(i[d].d,t,n):(0,s.describeNode)(i[d].d)},f=0;return p.items.forEach(function(t){if(l(t,f,e.vegaLiteSpec)){v(t,"group",u,f,p);var i=0,n=t.items[0].mark.items[0].items?t.items[0].mark.items[0]:t;n.items.forEach(function(a){d(a,i,t,e.vegaLiteSpec)&&v(a,"item",u,i,n),i++})}f++}),Object.keys(i).forEach(function(t){i[t].edges=function(t){var a=i[t],o=a.index,s=a.level,r=a.parent,l=[],d=r.items[o-1];if(d){var c=g(d,s);if(i[c]){var u="".concat(c,"-").concat(a.id);l.push(u),n[u]||(n[u]={source:c,target:a.id,navigationRules:["left","right"]})}}var p=r.items[o+1];if(p){var v=g(p,s);if(i[v]){var f="".concat(a.id,"-").concat(v);l.push(f),n[f]||(n[f]={source:a.id,target:v,navigationRules:["left","right"]})}}if("group"===s&&r.items[o].items){var m=(r.items[o].items[0].mark.items[0].items||r.items[o].items)[0],y=g(m,"item");if(i[y]){var h="".concat(a.id,"-").concat(y);l.push(h),n[h]||(n[h]={source:a.id,target:y,navigationRules:["parent","child"]})}}else if("item"===s){var b=g(r,"group");if(i[b]){var x="".concat(b,"-").concat(a.id);l.push(x),n[x]||(n[x]={source:b,target:a.id,navigationRules:["parent","child"]})}}return e.exitFunction&&(l.push("any-exit"),n["any-exit"]||(n["any-exit"]={source:e.getCurrent,target:e.exitFunction,navigationRules:["exit"]})),l.push("any-undo"),n["any-undo"]||(n["any-undo"]={source:e.getCurrent,target:e.getPrevious,navigationRules:["undo"]}),l}(t)}),{nodes:i,edges:n,elementData:a,navigationRules:t}},t.addSimpleDataIDs=function(e){var t=0,i={};e.data.forEach(function(n){var a="function"==typeof e.idKey?e.idKey(n):e.idKey;n[a]="_"+t,e.keysForIdGeneration&&e.keysForIdGeneration.forEach(function(e){e in n&&("string"==typeof n[e]?(i[e]||(i[e]=0),i[n[e]]||(i[n[e]]=0),n[a]+="_"+e+i[e]+"_"+n[e]+i[n[e]],i[e]++,i[n[e]]++):(i[e]||(i[e]=0),n[a]+="_"+e+i[e],i[e]++))}),t++})},t.buildNodes=function(e){var t={};return e.data.forEach(function(i){e.idKey||console.error("Building nodes. A key string must be supplied in options.idKey to specify the id keys of every node.");var n="function"==typeof e.idKey?e.idKey(i):e.idKey,a=i[n];if(a)if(t[a])console.error("Building nodes. Each id for data in options.data must be unique. This id is not unique: ".concat(a,"."));else{var o="function"==typeof e.renderIdKey?e.renderIdKey(i):e.renderIdKey;t[a]={id:a,edges:[],renderId:o?i[o]||"":i.renderIdKey||"",data:i}}else console.error("Building nodes. Each datum in options.data must contain an id. When matching the id key string ".concat(n,", this datum has no id: ").concat(JSON.stringify(i),"."))}),t},t.scaffoldDimensions=function(e,t){var i,r,l={};if(null===(r=null===(i=e.dimensions)||void 0===i?void 0:i.parentOptions)||void 0===r?void 0:r.addLevel0){var d=e.dimensions.parentOptions.addLevel0;t[d.id]=n(n({},d),{dimensionLevel:0})}var c=a([],o.GenericFullNavigationDimensions,!0);return e.data.forEach(function(i){var o=e.dimensions.values||[],r=0;o.forEach(function(o){var d,u,p,g,v,f,m,y;if(o.dimensionKey){if(o.dimensionKey in i){var h=i[o.dimensionKey],b="function"!=typeof(null===(d=o.operations)||void 0===d?void 0:d.filterFunction)||o.operations.filterFunction(i,o);if(void 0!==h&&b){if(o.type||(o.type="bigint"==typeof h||"number"==typeof h?"numerical":"categorical"),!l[o.dimensionKey]){var x="function"==typeof o.nodeId?o.nodeId(o,e.data):o.nodeId||(0,s.createValidId)(o.dimensionKey),E="function"==typeof o.renderId?o.renderId(o,e.data):o.renderId||x;l[o.dimensionKey]={dimensionKey:o.dimensionKey,nodeId:x,divisions:{},numericalExtents:[1/0,-1/0],type:o.type,operations:{compressSparseDivisions:(null===(u=o.operations)||void 0===u?void 0:u.compressSparseDivisions)||!1,sortFunction:(null===(p=o.operations)||void 0===p?void 0:p.sortFunction)||void 0},behavior:o.behavior||{extents:"circular"},navigationRules:o.navigationRules||{sibling_sibling:c.length?a([],c.shift(),!0):["previous_"+o.dimensionKey,"next_"+o.dimensionKey],parent_child:["parent_"+o.dimensionKey,"child"]}},t[x]={id:x,renderId:E,derivedNode:o.dimensionKey,edges:[],dimensionLevel:1,data:l[o.dimensionKey],renderingStrategy:o.renderingStrategy||"singleSquare"}}var w=l[o.dimensionKey],I=null;if("categorical"===o.type){var R="function"==typeof(null===(g=o.divisionOptions)||void 0===g?void 0:g.divisionNodeIds)?o.divisionOptions.divisionNodeIds(o.dimensionKey,h,r):(0,s.createValidId)(w.nodeId+"_"+h);if(!(I=w.divisions[R])){I=w.divisions[R]={id:R,sortFunction:(null===(v=o.divisionOptions)||void 0===v?void 0:v.sortFunction)||void 0,values:{}};var k="function"==typeof(null===(f=o.divisionOptions)||void 0===f?void 0:f.divisionRenderIds)?o.divisionOptions.divisionRenderIds(o.dimensionKey,h,r):R;t[R]={id:R,renderId:k,derivedNode:o.dimensionKey,edges:[],dimensionLevel:2,data:n({},I),renderingStrategy:(null===(m=o.divisionOptions)||void 0===m?void 0:m.renderingStrategy)||"singleSquare"},t[R].data[o.dimensionKey]=h}}else{(I=w.divisions[w.nodeId])||(I=w.divisions[w.nodeId]={id:w.nodeId,sortFunction:(null===(y=o.divisionOptions)||void 0===y?void 0:y.sortFunction)||void 0,values:{}}),o.operations||(o.operations={});var L=o.operations.createNumericalSubdivisions;w.subdivisions="number"==typeof L&&L<1?1:L||1,1!==L&&(w.divisionOptions||(w.divisionOptions=o.divisionOptions),function(e,t){var i=t.numericalExtents[0],n=t.numericalExtents[1];t.numericalExtents[0]=i<e?i:e,t.numericalExtents[1]=n>e?n:e}(h,w))}var B="function"==typeof e.idKey?e.idKey(i):e.idKey;I.values[i[B]]=i}}r++}else console.error("Building nodes, parsing dimensions. Each dimension in options.dimensions must contain a dimensionKey. This dimension has no key: ".concat(JSON.stringify(o),"."))})}),Object.keys(l).forEach(function(e){var i,n,a,o,s,r=l[e],d=r.divisions;if("numerical"===r.type){d[r.nodeId].values=Object.fromEntries(Object.entries(d[r.nodeId].values).sort(function(t,i){var n;return"function"==typeof(null===(n=r.operations)||void 0===n?void 0:n.sortFunction)?r.operations.sortFunction(t[1],i[1],r):t[1][e]-i[1][e]}));var c=d[r.nodeId].values;if(r.numericalExtents[0]!==1/0&&1!==r.subdivisions){var u=Object.keys(c),p="function"==typeof r.subdivisions?r.subdivisions(e,c):r.subdivisions,g=(r.numericalExtents[1]-r.numericalExtents[0])/p,v=r.numericalExtents[0]+g,f=0;for(v=r.numericalExtents[0]+g;v<=r.numericalExtents[1];v+=g){var m="function"==typeof(null===(i=r.divisionOptions)||void 0===i?void 0:i.divisionNodeIds)?r.divisionOptions.divisionNodeIds(e,v,v):r.nodeId+"_"+v;r.divisions[m]={id:m,sortFunction:(null===(n=r.divisionOptions)||void 0===n?void 0:n.sortFunction)||void 0,values:{}};var y="function"==typeof(null===(a=r.divisionOptions)||void 0===a?void 0:a.divisionRenderIds)?r.divisionOptions.divisionRenderIds(e,v,v):m;t[m]={id:m,renderId:y,derivedNode:e,edges:[],data:r.divisions[m],dimensionLevel:2,renderingStrategy:(null===(o=r.divisionOptions)||void 0===o?void 0:o.renderingStrategy)||"singleSquare"};for(var h=!1;!h&&f<u.length;){var b=c[u[f]];b[e]<=v?r.divisions[m].values[b.id]=b:(v+=g,h=!0),f++}}delete d[e]}}else"function"==typeof(null===(s=r.operations)||void 0===s?void 0:s.sortFunction)&&(r.divisions=Object.fromEntries(Object.entries(d).sort(function(e,t){return r.operations.sortFunction(e[1],t[1],r)})));Object.keys(r.divisions).forEach(function(e){var t=r.divisions[e];"function"==typeof t.sortFunction&&(t.values=Object.fromEntries(Object.entries(t.values).sort(function(e,i){return t.sortFunction(e[1],i[1],t)})))})}),Object.keys(l).forEach(function(e){var i=l[e];if(i.operations.compressSparseDivisions){var a=Object.keys(i.divisions),o={},s=!0;if(a.forEach(function(e){var t=i.divisions[e],a=Object.keys(t.values);a.length<=1?a.forEach(function(e){o[e]=n({},t.values[e])}):s=!1}),s){var r={id:i.nodeId,values:o};a.forEach(function(e){delete t[e]}),i.divisions={},i.divisions[i.nodeId]=r}}}),e.dimensions.adjustDimensions&&(l=e.dimensions.adjustDimensions(l)),l},t.buildEdges=function(e,t,i){var n,o,s,r,l,d,c,u,p,g,v={},f=function(e,i){-1===t[e].edges.indexOf(i)&&t[e].edges.push(i)},m=function(t,i,n,o){var s="".concat(t,"-").concat(i),r=e.useDirectedEdges?"".concat(i,"-").concat(s):s,l=!o||"source"===o,d=!o||"target"===o,c=function(e){var o;v[e]?(o=v[e].navigationRules).push.apply(o,n||[]):v[e]={source:t,target:i,navigationRules:n?a([],n,!0):[]}};c(s),e.useDirectedEdges&&d&&c(r),l&&f(t,s),d&&f(i,r)};if(i&&Object.keys(i).length){var y=Object.keys(i),h=null===(s=null===(o=null===(n=e.dimensions)||void 0===n?void 0:n.parentOptions)||void 0===o?void 0:o.level1Options)||void 0===s?void 0:s.order,b=h||y,x=0,E=(null===(r=e.dimensions)||void 0===r?void 0:r.parentOptions)||{},w=(null===(d=null===(l=E.level1Options)||void 0===l?void 0:l.behavior)||void 0===d?void 0:d.extents)||"terminal",I=E.addLevel0,R=I?(null===(u=null===(c=E.level1Options)||void 0===c?void 0:c.navigationRules)||void 0===u?void 0:u.parent_child)||["parent","child"]:[],k=(null===(g=null===(p=E.level1Options)||void 0===p?void 0:p.navigationRules)||void 0===g?void 0:g.sibling_sibling)||["left","right"],L="string"==typeof b[0]?h?t[b[0]]:t[i[b[0]].nodeId]:b[0];I&&m(I.id,L.id,R,"source"),b.forEach(function(n){var a="string"==typeof n?h?t[n]:t[i[n].nodeId]:n;if(a!==n||t[a.id]||(t[a.id]=a),I&&(e.useDirectedEdges?m(a.id,I.id,R,"source"):m(I.id,a.id,R,"target")),x===b.length-1&&"circular"===w)m(a.id,L.id,k);else if(x===b.length-1&&"bridgedCustom"===w)m(a.id,E.level1Options.behavior.customBridgePost,k);else if(x<b.length-1){var o="string"==typeof b[x+1]?h?t[b[x+1]]:t[i[b[x+1]].nodeId]:b[x+1];m(a.id,o.id,k)}x||"bridgedCustom"!==w||m(E.level1Options.behavior.customBridgePost,a.id,k),x++}),y.forEach(function(t){var n,a,o,s,r=i[t],l=(null===(n=r.behavior)||void 0===n?void 0:n.childmostNavigation)||"within",d="across"===l&&(null===(a=r.behavior)||void 0===a?void 0:a.childmostMatching)?null===(o=r.behavior)||void 0===o?void 0:o.childmostMatching:function(e,t,i,n){return n.values[Object.keys(n.values)[e]]||void 0},c=(null===(s=r.behavior)||void 0===s?void 0:s.extents)||"circular";r.divisions||console.error("Parsing dimensions. The dimension using the key ".concat(t," is missing the divisions property. dimension.divisions should be supplied. ").concat(JSON.stringify(r),"."));var u=Object.keys(r.divisions),p=r.divisions[u[0]];if(1!==u.length)m(r.nodeId,p.id,r.navigationRules.parent_child,"source");else{var g=Object.keys(p.values),v="function"==typeof e.idKey?e.idKey(p.values[g[0]]):e.idKey;m(r.nodeId,p.values[g[0]][v],r.navigationRules.parent_child,"source")}var f=0;u.forEach(function(t){var i=r.divisions[t];f!==u.length-1||"circular"!==c&&"bridgedCousins"!==c&&"bridgedCustom"!==c?f<u.length-1&&m(i.id,r.divisions[u[f+1]].id,r.navigationRules.sibling_sibling):m(i.id,r.divisions[u[0]].id,r.navigationRules.sibling_sibling);var n=Object.keys(i.values);e.useDirectedEdges?m(i.id,r.nodeId,r.navigationRules.parent_child,"source"):m(r.nodeId,i.id,r.navigationRules.parent_child,"target");var a="function"==typeof e.idKey?e.idKey(i.values[n[0]]):e.idKey;m(i.id,i.values[n[0]][a],r.navigationRules.parent_child,"source");var o=0;n.length>1&&n.forEach(function(t){var a=i.values[t],s="function"==typeof e.idKey?e.idKey(a):e.idKey,p=1!==u.length?i.id:r.nodeId;if(e.useDirectedEdges?m(a[s],p,r.navigationRules.parent_child,"source"):m(p,a[s],r.navigationRules.parent_child,"target"),"within"===l){if(o===n.length-1&&"circular"===c){var g="function"==typeof e.idKey?e.idKey(i.values[n[0]]):e.idKey;m(a[s],i.values[n[0]][g],r.navigationRules.sibling_sibling)}else o===n.length-1&&"bridgedCousins"===c?f!==u.length-1?(g="function"==typeof e.idKey?e.idKey(r.divisions[u[f+1]].values[n[0]]):e.idKey,m(a[s],r.divisions[u[f+1]].values[n[0]][g],r.navigationRules.sibling_sibling)):(g="function"==typeof e.idKey?e.idKey(r.divisions[u[0]].values[n[0]]):e.idKey,m(a[s],r.divisions[u[0]].values[n[0]][g],r.navigationRules.sibling_sibling)):o===n.length-1&&"bridgedCustom"===c?m(a[s],r.behavior.customBridgePost,r.navigationRules.sibling_sibling):o<n.length-1&&(g="function"==typeof e.idKey?e.idKey(i.values[n[o+1]]):e.idKey,m(a[s],i.values[n[o+1]][g],r.navigationRules.sibling_sibling));o||"bridgedCousins"!==c?o||"bridgedCustom"!==c||m(r.behavior.customBridgePrevious,a[s],r.navigationRules.sibling_sibling):0!==f?(g="function"==typeof e.idKey?e.idKey(r.divisions[u[f-1]].values[n[n.length-1]]):e.idKey,m(r.divisions[u[f-1]].values[n[n.length-1]][g],a[s],r.navigationRules.sibling_sibling)):(g="function"==typeof e.idKey?e.idKey(r.divisions[u[u.length-1]].values[n[n.length-1]]):e.idKey,m(r.divisions[u[u.length-1]].values[n[n.length-1]][g],a[s],r.navigationRules.sibling_sibling))}else if(f===u.length-1&&"bridgedCustom"===c)m(a[s],r.behavior.customBridgePost,r.navigationRules.sibling_sibling);else if(f||"bridgedCustom"!==c){var v=f===u.length-1&&"circular"===c?r.divisions[u[0]]:r.divisions[u[f+1]];if(v){var y=d(o,a[s],i,v);y&&(g="function"==typeof e.idKey?e.idKey(y):e.idKey,m(a[s],y[g],r.navigationRules.sibling_sibling))}}else m(r.behavior.customBridgePrevious,a[s],r.navigationRules.sibling_sibling);o++}),f++})})}return Object.keys(t).forEach(function(i){var n,a=t[i];(null===(n=e.genericEdges)||void 0===n?void 0:n.length)&&e.genericEdges.forEach(function(e){v[e.edgeId]||(v[e.edgeId]=e.edge),(!e.conditional||e.conditional&&e.conditional(a,e))&&a.edges.push(e.edgeId)})}),v},t.buildRules=function(e,t,i){var s,r,l,d,c=e.navigationRules;if(!c){var u=Object.keys(i||{});u.length>6&&console.error("Building navigationRules. Dimension count is too high to automatically generate key commands. It is recommend you reduce your dimensions to 6 or fewer for end-user experience. If not, you must provide your own navigation rules in options.navigationRules. Details: Count is ".concat(u.length,". Dimensions counted: ").concat(u.join(", "),"."));var p={},g={},v={},f=a([],o.TypicallyUnreservedKeyPairs,!0),m=a([],o.TypicallyUnreservedKeys,!0),y=function(t,i){var o=t&&i,s=!1,r=!1;if((p[t]||g[t])&&(g[t]=n({},p[t]),s=!0),i&&(p[i]||g[i])&&(g[i]=n({},p[i]),r=!0),!o||s||r){if(!g[t]&&m.length){var l=m.shift(),d=[];f.forEach(function(e){l!==e[0]&&l!==e[1]&&d.push(e)}),f=d,g[t]={direction:e.useDirectedEdges?"target":"source",key:l}}if(i&&!g[i]&&m.length){var c=m.shift(),u=[];f.forEach(function(e){c!==e[0]&&c!==e[1]&&u.push(e)}),f=u,g[i]={direction:"target",key:c}}m.length||(g[t]||(v[t]=t),i&&!g[i]&&(v[i]=i))}else{f.length||console.error("Building navigationRules. Dimension count is too high to automatically generate key commands, we have run out of keyboard key pairs to assign. You must either provide your own navigation rules in options.navigationRules, provide rules when generating dimensions, or reduce dimension count.");var y=a([],f.shift(),!0);m.splice(m.indexOf(y[0]),1),m.splice(m.indexOf(y[1]),1),g[t]={direction:e.useDirectedEdges?"target":"source",key:y[0]},g[i]={direction:"target",key:y[1]}}};if(Object.keys(o.GenericFullNavigationRules).forEach(function(t){var i=n({},o.GenericFullNavigationRules[t]);e.useDirectedEdges&&(i.direction="target"),p[t]=i}),u.length){if(null===(r=null===(s=e.dimensions)||void 0===s?void 0:s.parentOptions)||void 0===r?void 0:r.addLevel0){var h=(null===(d=null===(l=e.dimensions.parentOptions.level1Options)||void 0===l?void 0:l.navigationRules)||void 0===d?void 0:d.parent_child)||["parent","child"];y(h[0],h[1])}u.forEach(function(e){var t=i[e].navigationRules.parent_child,n=i[e].navigationRules.sibling_sibling;y(t[0],t[1]),y(n[0],n[1])})}if(Object.keys(t).forEach(function(e){t[e].navigationRules.forEach(function(e){g[e]||y(e)})}),Object.keys(v).length){var b={};Object.keys(g).forEach(function(e){b[g[e].key]=g[e].key}),Object.keys(p).forEach(function(e){b[p[e].key]||o.SemanticKeys[p[e].key]||m.push(p[e].key)});var x=n({},v);v={},Object.keys(x).forEach(function(e){y(e)}),Object.keys(v).length&&console.error("Building navigationRules. There are no more keys left to assign automatically. Recommended fixes: use fewer dimensions, use fewer GenericEdges, or build your own navigationRules. Rules remaining without keyboard keys: ".concat(Object.keys(v).join(", "),"."))}c=g}return c},t.buildStructure=function(e){e.addIds&&(0,t.addSimpleDataIDs)(e);var i=(0,t.buildNodes)(e),n=(0,t.scaffoldDimensions)(e,i),a=(0,t.buildEdges)(e,i,n);return{nodes:i,edges:a,dimensions:n,navigationRules:(0,t.buildRules)(e,a,n)}}},156(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(149),a=i(788),o=i(676);t.default={structure:n.default,input:a.default,rendering:o.default}},676(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},n.apply(this,arguments)},a=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var o=i(66);t.default=function(e){var t=function(e){s.wrapper.setAttribute("aria-activedescendant",e.srcElement.id)},i=function(){s.wrapper.setAttribute("aria-activedescendant","")},s={},r=!1,l={cssClass:o.NodeElementDefaults.cssClass,spatialProperties:n({},o.NodeElementDefaults.spatialProperties),semantics:n({},o.NodeElementDefaults.semantics),parentSemantics:n({},o.NodeElementDefaults.parentSemantics),existingElement:n({},o.NodeElementDefaults.existingElement)};return e.defaults&&(l.cssClass=e.defaults.cssClass||l.cssClass,l.spatialProperties=e.defaults.spatialProperties?n(n({},l.spatialProperties),e.defaults.spatialProperties):l.spatialProperties,l.semantics=e.defaults.semantics?n(n({},l.semantics),e.defaults.semantics):l.semantics,l.parentSemantics=e.defaults.parentSemantics?n(n({},l.parentSemantics),e.defaults.parentSemantics):l.parentSemantics,l.existingElement=e.defaults.existingElement?n(n({},l.existingElement),e.defaults.existingElement):l.existingElement),s.initialize=function(){var t;if(r)console.error("The renderer wrapper has already been initialized successfully, RenderingOptions.suffixId is: ".concat(e.suffixId,". No further action was taken."));else if(e.root&&document.getElementById(e.root.id)){if(s.root=document.getElementById(e.root.id),s.root.style.position="relative",s.root.classList.add("dn-root"),e.suffixId)return s.wrapper=document.createElement("div"),s.wrapper.id="dn-wrapper-"+e.suffixId,s.wrapper.setAttribute("role","application"),s.wrapper.setAttribute("aria-label",e.root.description||"Data navigation structure"),s.wrapper.setAttribute("aria-activedescendant",""),s.wrapper.classList.add("dn-wrapper"),s.wrapper.style.width=e.root&&e.root.width?e.root.width:"100%",e.root&&e.root.height&&(s.wrapper.style.height=e.root.height),e.entryButton&&e.entryButton.include&&(s.entryButton=document.createElement("button"),s.entryButton.id="dn-entry-button-"+e.suffixId,s.entryButton.classList.add("dn-entry-button"),s.entryButton.innerText="Enter navigation area",e.entryButton.callbacks&&e.entryButton.callbacks.click&&s.entryButton.addEventListener("click",e.entryButton.callbacks.click),e.entryButton.callbacks&&e.entryButton.callbacks.focus&&s.entryButton.addEventListener("focus",e.entryButton.callbacks.focus),s.wrapper.appendChild(s.entryButton)),s.root.appendChild(s.wrapper),(null===(t=e.exitElement)||void 0===t?void 0:t.include)&&(s.exitElement=document.createElement("div"),s.exitElement.id="dn-exit-"+e.suffixId,s.exitElement.classList.add("dn-exit-position"),s.exitElement.innerText="End of data structure.",s.exitElement.setAttribute("aria-label","End of data structure."),s.exitElement.setAttribute("role","note"),s.exitElement.setAttribute("tabindex","-1"),s.exitElement.style.display="none",s.exitElement.addEventListener("focus",function(t){var i,n;s.exitElement.style.display="block",s.clearStructure(),(null===(n=null===(i=e.exitElement)||void 0===i?void 0:i.callbacks)||void 0===n?void 0:n.focus)&&e.exitElement.callbacks.focus(t)}),s.exitElement.addEventListener("blur",function(t){var i,n;s.exitElement.style.display="none",(null===(n=null===(i=e.exitElement)||void 0===i?void 0:i.callbacks)||void 0===n?void 0:n.blur)&&e.exitElement.callbacks.blur(t)}),s.root.appendChild(s.exitElement)),r=!0,s.root;console.error("No suffix id found: options.suffixId must be specified.")}else console.error("No root element found, cannot build: RenderingOptions.root.id must reference an existing DOM element in order to render children.")},s.render=function(n){var a=n.renderId+"",o=e.elementData[a];if(o){if(r){var d=!1,c={},u=function(e,t,i){var a,s=o[e]||l[e],r=i&&d?c[t]:null==s?void 0:s[t],u=null===(a=l[e])||void 0===a?void 0:a[t];return"function"==typeof s?s(o,n.datum):"function"==typeof r?r(o,n.datum):r||u||(t?void 0:s)};d=u("existingElement","useForSpatialProperties"),c=u("existingElement","spatialProperties");var p=parseFloat(u("spatialProperties","width",!0)||0),g=parseFloat(u("spatialProperties","height",!0)||0),v=parseFloat(u("spatialProperties","x",!0)||0),f=parseFloat(u("spatialProperties","y",!0)||0),m=document.createElement(u("parentSemantics","elementType")),y=u("parentSemantics","attributes");"object"==typeof y&&Object.keys(y).forEach(function(e){m.setAttribute(e,y[e])}),m.setAttribute("role",u("parentSemantics","role")),m.id=a,m.classList.add("dn-node"),m.classList.add(u("cssClass")),m.style.width=p+"px",m.style.height=g+"px",m.style.left=v+"px",m.style.top=f+"px",m.setAttribute("tabindex","0"),m.addEventListener("focus",t),m.addEventListener("blur",i);var h=document.createElement(u("semantics","elementType")),b=u("semantics","attributes");"object"==typeof b&&Object.keys(b).forEach(function(e){m.setAttribute(e,b[e])}),h.setAttribute("role",u("semantics","role")),h.classList.add("dn-node-text"),o.showText&&(h.innerText=o.semantics.label);var x=u("semantics","label");x||console.error("Accessibility error: a label must be supplied to every rendered element using semantics.label."),h.setAttribute("aria-label",x),m.appendChild(h);var E=u("spatialProperties","path");if(E){var w=p+v+10,I=g+f+10,R=document.createElementNS("http://www.w3.org/2000/svg","svg");R.setAttribute("width",w+""),R.setAttribute("height",I+""),R.setAttribute("viewBox","0 0 ".concat(w," ").concat(I)),R.style.left=-v+"px",R.style.top=-f+"px",R.classList.add("dn-node-svg"),R.setAttribute("role","presentation"),R.setAttribute("focusable","false");var k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",E),k.classList.add("dn-node-path"),R.appendChild(k),m.appendChild(R)}return s.wrapper.appendChild(m),m}console.error("render() was called before initialize(), renderer must be initialized first.")}else console.warn("Render data not found with renderId: ".concat(a,". Failed to render."))},s.remove=function(e){var n=document.getElementById(e);s.wrapper.getAttribute("aria-activedescendant")===e&&s.wrapper.setAttribute("aria-activedescendant",""),n&&(n.removeEventListener("focus",t),n.removeEventListener("blur",i),n.remove())},s.clearStructure=function(){a([],s.wrapper.children,!0).forEach(function(e){s.entryButton&&s.entryButton===e||s.remove(e.id)})},s}},788(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(66);t.default=function(e){var t={},i=n.defaultKeyBindings,a=n.GenericFullNavigationRules;return t.moveTo=function(t){var i=e.structure.nodes[t];if(i)return i},t.move=function(i,n){if(i){var o=e.structure.nodes[i];if(o.edges){var s=null,r=0,l=a[n];if(!l)return;var d=function(){var t=e.structure.edges[o.edges[r]];if(t.navigationRules.forEach(function(e){s||(s=function(e,t){if(e!==n)return null;var a={target:"string"==typeof t.target?t.target:t.target(o,i),source:"string"==typeof t.source?t.source:t.source(o,i)};return a[l.direction]!==i?a[l.direction]:null}(e,t))}),s)return"break"};for(r=0;r<o.edges.length&&"break"!==d();r++);return s?t.moveTo(s):void 0}}},t.enter=function(){return e.entryPoint?t.moveTo(e.entryPoint):void console.error("No entry point was specified in InputOptions, returning undefined")},t.exit=function(){return e.exitPoint?e.exitPoint:void console.error("No exit point was specified in InputOptions, returning undefined")},t.keydownValidator=function(e){var t=i[e.code];if(t)return t},t.focus=function(e){var t=document.getElementById(e);t&&t.focus()},t.setNavigationKeyBindings=function(e){e?(i={},a=e,Object.keys(e).forEach(function(t){var n=e[t];i[n.key]=t})):(i=n.defaultKeyBindings,a=n.GenericFullNavigationRules)},t.setNavigationKeyBindings(e.navigationRules),t}},864(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createValidId=t.describeNode=void 0,t.describeNode=function(e,t){var i=Object.keys(e),n="";return i.forEach(function(i){n+="".concat(t&&t.omitKeyNames?"":i+": ").concat(e[i],". ")}),n+=t&&t.semanticLabel||"Data point."},t.createValidId=function(e){return"_"+e.replace(/[^a-zA-Z0-9_-]+/g,"_")}}},t={};function i(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,i),o.exports}var n=i(156),a=i(864);let o,s,r,l,d="",c={title:{d:{title:"Major Trophies for some English teams"},spatialProperties:{x:12,y:9,width:686,height:56},id:"title",renderId:"title",edges:["any-return","any-exit","title-legend"],semantics:{label:"Major Trophies for some English teams"}},legend:{d:{legend:"Contests Included: BPL, FA Cup, CL"},spatialProperties:{x:160,y:162,width:398,height:49},id:"legend",renderId:"legend",edges:["any-return","any-exit","title-legend","legend-y_axis","legend-bpl"],semantics:{label:"Legend. Contests Included: BPL, FA Cup, CL. Press Enter to explore these contests."}},y_axis:{d:{"Y Axis":"Label: Count trophies. Values range from 0 to 30 on a numerical scale."},spatialProperties:{x:21,y:311,width:39,height:194},id:"y_axis",renderId:"y_axis",edges:["any-return","any-exit","legend-y_axis","y_axis-x_axis"],semantics:{label:"Y Axis. Label: Count trophies. Values range from 0 to 30 on a numerical scale."}},x_axis:{d:{"X Axis":"Teams included: Arsenal, Chelsea, Liverpool, Manchester United."},spatialProperties:{x:191,y:736,width:969,height:44},id:"x_axis",renderId:"x_axis",edges:["any-return","any-exit","y_axis-x_axis","x_axis-arsenal"],semantics:{label:"X Axis. Arsenal, Chelsea, Liverpool, Manchester United. Press Enter to explore these teams."}},arsenal:{d:{team:"Arsenal","total trophies":17},spatialProperties:{x:194,y:370,width:122,height:357},id:"arsenal",renderId:"arsenal",edges:["any-return","any-exit","x_axis-arsenal","any-x_axis","arsenal-bpl1","arsenal-chelsea","manchester-arsenal","any-legend"],semantics:{label:(0,a.describeNode)({team:"Arsenal","total trophies":17,contains:"3 contests"},{})}},chelsea:{d:{team:"Chelsea","total trophies":15},spatialProperties:{x:458,y:414,width:122,height:312},id:"chelsea",renderId:"chelsea",edges:["any-return","any-exit","any-x_axis","arsenal-chelsea","chelsea-bpl2","chelsea-liverpool","any-legend"],semantics:{label:(0,a.describeNode)({team:"Chelsea","total trophies":15,contains:"3 contests"},{})}},liverpool:{d:{team:"Liverpool","total trophies":15},spatialProperties:{x:722,y:414,width:122,height:312},id:"liverpool",renderId:"liverpool",edges:["any-return","any-exit","any-x_axis","chelsea-liverpool","liverpool-bpl3","liverpool-manchester","any-legend"],semantics:{label:(0,a.describeNode)({team:"Liverpool","total trophies":15,contains:"3 contests"},{})}},manchester:{d:{team:"Manchester United","total trophies":28},spatialProperties:{x:986,y:138,width:122,height:589},id:"manchester",renderId:"manchester",edges:["any-return","any-exit","any-x_axis","liverpool-manchester","manchester-bpl4","manchester-arsenal","any-legend"],semantics:{label:(0,a.describeNode)({team:"Manchester","total trophies":28,contains:"3 contests"},{})}},bpl:{d:{contest:"BPL","total trophies":22},spatialProperties:{x:194,y:138,width:918,height:378,path:"M987 136H985.762L985.21 137.108L848.762 411H720H584H457.309L321.603 368.093L321.309 368H321H196H194V370V430V432H196H320.431L458.948 517.701L459.431 518H460H584H584.579L585.069 517.69L720.579 432H850H850.152L850.303 431.977L987.152 411H1112H1114V409V138V136H1112H987Z"},id:"bpl",renderId:"bpl",edges:["any-return","any-exit","legend-bpl","any-legend","bpl-bpl1","bpl-fa","cl-bpl"],semantics:{label:(0,a.describeNode)({contest:"BPL","total trophies":22,contains:"4 teams"},{})}},fa:{d:{contest:"FA Cup","total trophies":42},spatialProperties:{x:194,y:414,width:918,height:311,path:"M987.407 412H987.263L987.119 412.021L849.712 432H722.274H721.698L721.211 432.306L586.141 517H459.707L324.059 432.304L323.573 432H323H196H194V434V725V727H196H323H323.288L323.564 726.919L459.421 687H586.717H587.298L587.788 686.689L722.855 601H849.414L986.563 664.813L986.965 665H987.407H1112H1114V663V414V412H1112H987.407Z"},id:"fa",renderId:"fa",edges:["any-return","any-exit","any-legend","bpl-fa","fa-fa1","fa-cl"],semantics:{label:(0,a.describeNode)({contest:"FA Cup","total trophies":42,contains:"4 teams"},{})}},cl:{d:{contest:"CL","total trophies":11},spatialProperties:{x:194,y:609,width:918,height:116,path:"M321.731 723H191V727H322H457H585H721H849H987H1112H1114V725V666V664H1112H987.441L849.841 600.186L849.441 600H849H721H720.421L719.931 600.31L584.421 686H457H456.731L456.471 686.071L321.731 723Z"},id:"cl",renderId:"cl",edges:["any-return","any-exit","any-legend","fa-cl","cl-cl1","cl-bpl"],semantics:{label:(0,a.describeNode)({contest:"CL","total trophies":11,contains:"4 teams"},{})}},bpl1:{d:{contest:"BPL",team:"Arsenal",trophies:3},spatialProperties:{x:194,y:370,width:122,height:62},id:"bpl1",renderId:"bpl1",edges:["any-return","any-exit","any-legend","arsenal-bpl1","bpl-bpl1","bpl1-fa1","cl1-bpl1","bpl1-bpl2","bpl4-bpl1"],semantics:{label:(0,a.describeNode)({contest:"BPL",team:"Arsenal",trophies:3},{})}},fa1:{d:{contest:"FA Cup",team:"Arsenal",trophies:14},spatialProperties:{x:194,y:436,width:122,height:291},id:"fa1",renderId:"fa1",edges:["any-return","any-exit","any-legend","arsenal-fa1","fa-fa1","bpl1-fa1","fa1-cl1","fa1-fa2","fa4-fa1"],semantics:{label:(0,a.describeNode)({contest:"FA Cup",team:"Arsenal",trophies:14},{})}},cl1:{d:{contest:"CL",team:"Arsenal",trophies:0},spatialProperties:{x:194,y:727,width:122,height:0},id:"cl1",renderId:"cl1",edges:["any-return","any-exit","arsenal-cl1","any-legend","cl-cl1","fa1-cl1","cl1-bpl1","cl1-cl2","cl4-cl1"],semantics:{label:(0,a.describeNode)({contest:"CL",team:"Arsenal",trophies:0},{})}},bpl2:{d:{contest:"BPL",team:"Chelsea",trophies:5},spatialProperties:{x:458,y:414,width:122,height:103},id:"bpl2",renderId:"bpl2",edges:["any-return","any-exit","any-legend","chelsea-bpl2","bpl2-fa2","cl2-bpl2","bpl1-bpl2","bpl2-bpl3"],semantics:{label:(0,a.describeNode)({contest:"BPL",team:"Chelsea",trophies:5},{})}},fa2:{d:{contest:"FA Cup",team:"Chelsea",trophies:8},spatialProperties:{x:458,y:521,width:122,height:165},id:"fa2",renderId:"fa2",edges:["any-return","chelsea-fa2","any-exit","any-legend","bpl2-fa2","fa2-cl2","fa1-fa2","fa2-fa3"],semantics:{label:(0,a.describeNode)({contest:"FA Cup",team:"Chelsea",trophies:8},{})}},cl2:{d:{contest:"CL",team:"Chelsea",trophies:2},spatialProperties:{x:458,y:691,width:122,height:35},id:"cl2",renderId:"cl2",edges:["any-return","any-exit","any-legend","chelsea-cl2","fa2-cl2","cl2-bpl2","cl1-cl2","cl2-cl3"],semantics:{label:(0,a.describeNode)({contest:"CL",team:"Chelsea",trophies:2},{})}},bpl3:{d:{contest:"BPL",team:"Liverpool",trophies:1},spatialProperties:{x:722,y:414,width:122,height:18},id:"bpl3",renderId:"bpl3",edges:["any-return","any-exit","any-legend","liverpool-bpl3","bpl3-fa3","cl3-bpl3","bpl2-bpl3","bpl3-bpl4"],semantics:{label:(0,a.describeNode)({contest:"BPL",team:"Liverpool",trophies:1},{})}},fa3:{d:{contest:"FA Cup",team:"Liverpool",trophies:8},spatialProperties:{x:722,y:437,width:122,height:165},id:"fa3",renderId:"fa3",edges:["any-return","any-exit","any-legend","liverpool-fa3","bpl3-fa3","fa3-cl3","fa2-fa3","fa3-fa4"],semantics:{label:(0,a.describeNode)({contest:"FA Cup",team:"Liverpool",trophies:8},{})}},cl3:{d:{contest:"CL",team:"Liverpool",trophies:6},spatialProperties:{x:722,y:607,width:122,height:119},id:"cl3",renderId:"cl3",edges:["any-return","any-exit","any-legend","liverpool-cl3","fa3-cl3","cl3-bpl3","cl2-cl3","cl3-cl4"],semantics:{label:(0,a.describeNode)({contest:"CL",team:"Liverpool",trophies:6},{})}},bpl4:{d:{contest:"BPL",team:"Manchester United",trophies:13},spatialProperties:{x:986,y:138,width:122,height:273},id:"bpl4",renderId:"bpl4",edges:["any-return","any-exit","any-legend","manchester-bpl4","bpl4-fa4","cl4-bpl4","bpl3-bpl4","bpl4-bpl1"],semantics:{label:(0,a.describeNode)({contest:"BPL",team:"Manchester United",trophies:13},{})}},fa4:{d:{contest:"FA Cup",team:"Manchester United",trophies:12},spatialProperties:{x:986,y:414,width:122,height:250},id:"fa4",renderId:"fa4",edges:["any-return","any-exit","any-legend","manchester-fa4","bpl4-fa4","fa4-cl4","fa3-fa4","fa4-fa1"],semantics:{label:(0,a.describeNode)({contest:"FA Cup",team:"Manchester United",trophies:12},{})}},cl4:{d:{contest:"CL",team:"Manchester United",trophies:3},spatialProperties:{x:986,y:667,width:122,height:58},id:"cl4",renderId:"cl4",edges:["any-return","any-exit","any-legend","manchester-cl4","fa4-cl4","cl4-bpl4","cl3-cl4","cl4-cl1"],semantics:{label:(0,a.describeNode)({contest:"CL",team:"Manchester United",trophies:3},{})}}},u={right:{key:"ArrowRight",direction:"target"},left:{key:"ArrowLeft",direction:"source"},down:{key:"ArrowDown",direction:"target"},up:{key:"ArrowUp",direction:"source"},child:{key:"Enter",direction:"target"},parent:{key:"Backspace",direction:"source"},exit:{key:"Escape",direction:"target"},undo:{key:"Period",direction:"target"},legend:{key:"KeyL",direction:"target"}};const p={nodes:c,edges:{"any-legend":{source:()=>l,target:()=>+l.substring(l.length-1)?l.substring(0,l.length-1):"legend",navigationRules:["legend"]},"any-x_axis":{source:"x_axis",target:()=>l,navigationRules:["parent"]},"any-return":{source:()=>l,target:()=>r,navigationRules:["undo"]},"any-exit":{source:()=>l,target:()=>(h(),""),navigationRules:["exit"]},"x_axis-exit":{source:"x_axis",target:()=>(h(),""),navigationRules:["down"]},"x_axis-arsenal":{source:"x_axis",target:"arsenal",navigationRules:["child","parent"]},"arsenal-bpl1":{source:"arsenal",target:"bpl1",navigationRules:["child","parent"]},"arsenal-fa1":{source:"arsenal",target:"fa1",navigationRules:["child","parent"]},"arsenal-cl1":{source:"arsenal",target:"cl1",navigationRules:["child","parent"]},"chelsea-fa2":{source:"chelsea",target:"fa2",navigationRules:["child","parent"]},"chelsea-cl2":{source:"chelsea",target:"cl2",navigationRules:["child","parent"]},"liverpool-fa3":{source:"liverpool",target:"fa3",navigationRules:["child","parent"]},"liverpool-cl3":{source:"liverpool",target:"cl3",navigationRules:["child","parent"]},"manchester-fa4":{source:"manchester",target:"fa4",navigationRules:["child","parent"]},"manchester-cl4":{source:"manchester",target:"cl4",navigationRules:["child","parent"]},"arsenal-chelsea":{source:"arsenal",target:"chelsea",navigationRules:["left","right"]},"manchester-arsenal":{source:"manchester",target:"arsenal",navigationRules:["left","right"]},"title-legend":{source:"title",target:"legend",navigationRules:["up","down"]},"legend-y_axis":{source:"legend",target:"y_axis",navigationRules:["up","down"]},"legend-bpl":{source:"legend",target:"bpl",navigationRules:["child","parent"]},"y_axis-x_axis":{source:"y_axis",target:"x_axis",navigationRules:["up","down"]},"chelsea-bpl2":{source:"chelsea",target:"bpl2",navigationRules:["child","parent"]},"chelsea-liverpool":{source:"chelsea",target:"liverpool",navigationRules:["left","right"]},"liverpool-bpl3":{source:"liverpool",target:"bpl3",navigationRules:["child","parent"]},"liverpool-manchester":{source:"liverpool",target:"manchester",navigationRules:["left","right"]},"manchester-bpl4":{source:"manchester",target:"bpl4",navigationRules:["child","parent"]},"bpl-bpl1":{source:"bpl",target:"bpl1",navigationRules:["child","parent"]},"bpl-fa":{source:"bpl",target:"fa",navigationRules:["up","down"]},"cl-bpl":{source:"cl",target:"bpl",navigationRules:["up","down"]},"fa-fa1":{source:"fa",target:"fa1",navigationRules:["child","parent"]},"fa-cl":{source:"fa",target:"cl",navigationRules:["up","down"]},"cl-cl1":{source:"cl",target:"cl1",navigationRules:["child","parent"]},"bpl1-fa1":{source:"bpl1",target:"fa1",navigationRules:["up","down"]},"cl1-bpl1":{source:"cl1",target:"bpl1",navigationRules:["up","down"]},"bpl1-bpl2":{source:"bpl1",target:"bpl2",navigationRules:["left","right"]},"bpl4-bpl1":{source:"bpl4",target:"bpl1",navigationRules:["left","right"]},"fa1-cl1":{source:"fa1",target:"cl1",navigationRules:["up","down"]},"fa1-fa2":{source:"fa1",target:"fa2",navigationRules:["left","right"]},"fa4-fa1":{source:"fa4",target:"fa1",navigationRules:["left","right"]},"cl1-cl2":{source:"cl1",target:"cl2",navigationRules:["left","right"]},"cl4-cl1":{source:"cl4",target:"cl1",navigationRules:["left","right"]},"bpl2-fa2":{source:"bpl2",target:"fa2",navigationRules:["up","down"]},"cl2-bpl2":{source:"cl2",target:"bpl2",navigationRules:["up","down"]},"bpl2-bpl3":{source:"bpl2",target:"bpl3",navigationRules:["left","right"]},"fa2-cl2":{source:"fa2",target:"cl2",navigationRules:["up","down"]},"fa2-fa3":{source:"fa2",target:"fa3",navigationRules:["left","right"]},"cl2-cl3":{source:"cl2",target:"cl3",navigationRules:["left","right"]},"bpl3-fa3":{source:"bpl3",target:"fa3",navigationRules:["up","down"]},"cl3-bpl3":{source:"cl3",target:"bpl3",navigationRules:["up","down"]},"bpl3-bpl4":{source:"bpl3",target:"bpl4",navigationRules:["left","right"]},"fa3-cl3":{source:"fa3",target:"cl3",navigationRules:["up","down"]},"fa3-fa4":{source:"fa3",target:"fa4",navigationRules:["left","right"]},"cl3-cl4":{source:"cl3",target:"cl4",navigationRules:["left","right"]},"bpl4-fa4":{source:"bpl4",target:"fa4",navigationRules:["up","down"]},"cl4-bpl4":{source:"cl4",target:"bpl4",navigationRules:["up","down"]},"fa4-cl4":{source:"fa4",target:"cl4",navigationRules:["up","down"]}}},g=n.rendering({elementData:p.nodes,defaults:{cssClass:(e,t)=>e.spatialProperties.path?"dn-test-path":"dn-test-class"},suffixId:"data-navigator-schema",root:{id:"root",cssClass:"",width:"100%",height:0},entryButton:{include:!0,callbacks:{click:()=>{m()}}},exitElement:{include:!0}});g.initialize();const v=n.input({structure:p,navigationRules:u,entryPoint:"title",exitPoint:g.exitElement.id}),f=e=>{g.render({renderId:e.renderId,datum:e}).addEventListener("keydown",e=>{const t=v.keydownValidator(e);t&&(e.preventDefault(),y(t))}),(e=>{const t=document.getElementById("tooltip");t.classList.remove("hidden"),t.innerText=e.semantics.label;const i=t.getBoundingClientRect(),n=5*o,a=i.height+n;if("Manchester United"===e.d.team||"Liverpool"===e.d.team||!e.d.team&&"BPL"===e.d.contest){t.style.textAlign="right";const s=i.width;t.style.transform=`translate(${(e.spatialProperties.x+e.spatialProperties.width)*o+n-s+1}px,${e.spatialProperties.y*o-a}px)`}else t.style.textAlign="left",t.style.transform=`translate(${e.spatialProperties.x*o-n+1}px,${e.spatialProperties.y*o-a}px)`})(e),v.focus(e.renderId),s=!0,r=l,l=e.id,g.remove(r)},m=()=>{const e=v.enter();e&&f(e)},y=e=>{const t=v.move(l,e);t&&f(t)},h=()=>{s=!1,g.exitElement.style.display="block",v.focus(g.exitElement.id),r=l,l=null,g.remove(r),document.getElementById("tooltip").classList.add("hidden")},b=e=>{const t=Math.abs(e.deltaX)>Math.abs(e.deltaY)?"X":"Y",i=(Math.abs(e["delta"+t])+1e-9)/(Math.abs(e["delta"+("X"===t?"Y":"X")])+1e-9),n=e.deltaX<0,a=e.deltaX>0,o=e.deltaY<0,s=e.deltaY>0,r=i>.99&&i<=2?a&&o?"legend":a&&s?"child":n&&s?"undo":n&&o?"parent":null:a&&"X"===t?"right":s&&"Y"===t?"down":n&&"X"===t?"left":o&&"Y"===t?"up":null;l&&r&&y(r)},x=new Hammer(document.getElementById("root"),{});let E;x.get("pinch").set({enable:!1}),x.get("rotate").set({enable:!1}),x.get("pan").set({enable:!1}),x.get("swipe").set({direction:Hammer.DIRECTION_ALL,velocity:.2}),x.on("press",e=>{}),x.on("pressup",e=>{s?h():m()}),x.on("swipe",e=>{b(e)});let w=!1,I=!1,R=[];const k=document.getElementById("feed"),L=document.getElementById("canvas"),B=L.getContext("2d"),P={flipHorizontal:!0,iouThreshold:.5,scoreThreshold:.45,modelType:"ssd320fpnlite",modelSize:"small"},_=()=>{E.detect(k).then(e=>{if(e.length&&(E.renderPredictions(e,L,B,k),e.forEach(e=>{(I&&("point"===e.label||"open"===e.label)&&e.score>=.6||!I&&"closed"===e.label&&e.score>=.6)&&R.push(e)}),R.length>=8)){if(I){let e={};R.forEach(t=>{e[t.label]||(e[t.label]={},e[t.label].bbox=[0,0,0,0],e[t.label].count=0,e[t.label].total=0);let i=e[t.label];i.count++,i.total+=t.score,i.bbox[0]+=t.bbox[0],i.bbox[1]+=t.bbox[1],i.bbox[2]+=t.bbox[2],i.bbox[3]+=t.bbox[3]});let t={score:0,label:""};Object.keys(e).forEach(i=>{(!t.label||t.score<e[i].total)&&(t.label=i,t.score=e[i].total)});let i=e[t.label],n=i.count,a={bbox:[i.bbox[0]/n,i.bbox[1]/n,i.bbox[2]/n,i.bbox[3]/n],label:t.label,score:t.score/n};O(a)}else{let e=[0,0,0,0];R.forEach(t=>{e[0]+=t.bbox[0],e[1]+=t.bbox[1],e[2]+=t.bbox[2],e[3]+=t.bbox[3]}),K([e[0]/R.length,e[1]/R.length,e[2]/R.length,e[3]/R.length])}R=[]}w&&requestAnimationFrame(_)})},K=e=>{I=e,document.getElementById("ready").innerText="Yes!",document.getElementById("fist").style.left=(I[0]+I[2])/2-16+"px",document.getElementById("fist").style.top=(I[1]+I[3])/2-5+"px",document.getElementById("fist").style.display="block"},O=e=>{if(I){if("point"===e.label){const t={deltaX:I[2]-I[0]-(e.bbox[2]-e.bbox[0]),deltaY:I[3]-I[1]-(e.bbox[3]-e.bbox[1])};b(t)}"open"!==e.label||s?"open"===e.label&&s&&h():m(),I=!1,document.getElementById("ready").innerText="No.",document.getElementById("fist").style.display="none"}};document.getElementById("loadModel").addEventListener("click",()=>{document.getElementById("loadModel").disabled=!0,document.getElementById("status").classList.remove("hidden"),document.getElementById("ready").innerText="No. Loading model...",handTrack.load(P).then(e=>{E=e,document.getElementById("openWebcam").disabled=!1,document.getElementById("ready").innerText="No. Model loaded but webcam feed required."})}),document.getElementById("openWebcam").addEventListener("click",()=>{document.getElementById("openWebcam").disabled=!0,document.getElementById("closeWebcam").disabled=!1,document.getElementById("ready").innerText="No. Loading video feed...",handTrack.startVideo(k).then(e=>{document.getElementById("ready").innerText="Feed ready. Close your hand to prepare for gesture commands.",e&&(w=!0,document.getElementById("status").classList.remove("hidden"),document.getElementById("canvas").classList.remove("hidden"),_())})}),document.getElementById("closeWebcam").addEventListener("click",()=>{w=!1,handTrack.stopVideo(k),document.getElementById("openWebcam").remove(),document.getElementById("canvas").remove(),document.getElementById("loadModel").remove(),document.getElementById("closeWebcam").disabled=!0,document.getElementById("status").innerText="Video feed disabled. Model disposed! Reload page to try model again.",E.dispose()});const A=e=>{u[e]?(C(e),y(e)):"enter"!==e||s?"exit"===e&&s?(C(e),h()):"exit"===e||"enter"===e?N(e,!0):N(e):(C(e),m())},C=e=>{document.getElementById("alert").classList.remove("alert"),document.getElementById("alert").innerText=`Command valid. Attempting "${e}."`},N=(e,t)=>{document.getElementById("alert").classList.add("alert");const i=t?`"${e}" already issued as a command!`:`"${e}" not recognized as a command!`;document.getElementById("alert").innerText=`${i} Try another. (Commands are: ${d}.)`};document.getElementById("form").addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("textCommand").value.toLowerCase();A(t)});const S=window.SpeechRecognition||window.webkitSpeechRecognition,F=window.SpeechGrammarList||window.webkitSpeechGrammarList;if(window.SpeechRecognitionEvent||window.webkitSpeechRecognitionEvent,S){const e=Object.keys(u);e.push("enter"),d=e.join(", ");const t=new S;if(F){const i=new F,n="#JSGF V1.0; grammar colors; public <color> = "+e.join(" | ")+" ;";i.addFromString(n,1),t.grammars=i}t.continuous=!1,t.lang="en-US",t.interimResults=!1,t.maxAlternatives=1;const i=()=>{t.start(),document.getElementById("alert").classList.remove("alert"),document.getElementById("alert").innerText="Ready! Please speak a command."};document.getElementById("enableSpeech").addEventListener("click",i),t.onresult=e=>{const t=e.results[0][0].transcript;+e.results[0][0].confidence>=.65?A(t):(e=>{document.getElementById("alert").classList.add("alert"),document.getElementById("alert").innerText=`We thought we heard "${e}" but aren't sure. Please try again! Possible commands are: ${d}.`})(t)},t.onspeechend=function(){t.stop()}}else document.getElementById("enableSpeech").setAttribute("disabled",!0),document.getElementById("alert").innerText='Speech recognition is disabled on your browser or device. (A default on Firefox). You may need to enable Web Speech API\'s "SpeechRecognition" in your browser settings to continue.';const H=()=>{const e=+document.getElementById("chart").getBoundingClientRect().width;o=e/1200;const t=(1200-e)/2,i=document.querySelector(".dn-entry-button"),n=i.getBoundingClientRect(),a=+n.height/(2*o)-9,s=(n.width*o*(1/o)-n.width*o)/2;document.querySelector(".dn-wrapper").style.transform=`scale(${o}) translate(${-t}px,${-a}px)`,i.style.transform=`scale(${1/o}) translate(${s}px,0px)`};let j;window.onresize=()=>{clearTimeout(j),j=setTimeout(H,50)},H()})();