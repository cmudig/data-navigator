(()=>{"use strict";var e={312:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeElementDefaults=t.GenericLimitedNavigationRules=t.GenericFullNavigationPairs=t.GenericFullNavigationDimensions=t.GenericFullNavigationRules=t.TypicallyUnreservedKeyPairs=t.TypicallyUnreservedSoloKeys=t.TypicallyUnreservedKeys=t.defaultKeyBindings=t.SemanticKeys=void 0,t.SemanticKeys={Escape:!0,Enter:!0,Backspace:!0,ArrowLeft:!0,ArrowRight:!0,ArrowUp:!0,ArrowDown:!0},t.defaultKeyBindings={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down",Period:"forward",Comma:"backward",Escape:"parent",Enter:"child"},t.TypicallyUnreservedKeys=["KeyW","KeyJ","LeftBracket","RightBracket","Slash","Backslash"],t.TypicallyUnreservedSoloKeys=["KeyW","KeyJ"],t.TypicallyUnreservedKeyPairs=[["LeftBracket","RightBracket"],["Slash","Backslash"]],t.GenericFullNavigationRules={left:{key:"ArrowLeft",direction:"source"},right:{key:"ArrowRight",direction:"target"},up:{key:"ArrowUp",direction:"source"},down:{key:"ArrowDown",direction:"target"},child:{key:"Enter",direction:"target"},parent:{key:"Backspace",direction:"source"},backward:{key:"Comma",direction:"source"},forward:{key:"Period",direction:"target"},previous:{key:"Semicolon",direction:"source"},next:{key:"Quote",direction:"target"},exit:{key:"Escape",direction:"target"},help:{key:"KeyY",direction:"target"},undo:{key:"KeyZ",direction:"target"}},t.GenericFullNavigationDimensions=[["left","right"],["up","down"],["backward","forward"],["previous","next"]],t.GenericFullNavigationPairs={left:["left","right"],right:["left","right"],up:["up","down"],down:["up","down"],backward:["backward","forward"],forward:["backward","forward"],previous:["previous","next"],next:["previous","next"],parent:["parent","child"],child:["parent","child"],exit:["exit","undo"],undo:["undo","undo"]},t.GenericLimitedNavigationRules={right:{key:"ArrowRight",direction:"target"},left:{key:"ArrowLeft",direction:"source"},down:{key:"ArrowDown",direction:"target"},up:{key:"ArrowUp",direction:"source"},child:{key:"Enter",direction:"target"},parent:{key:"Backspace",direction:"source"},exit:{key:"Escape",direction:"target"},undo:{key:"Period",direction:"target"},legend:{key:"KeyL",direction:"target"}},t.NodeElementDefaults={cssClass:"",spatialProperties:{x:0,y:0,width:0,height:0,path:""},semantics:{label:"",elementType:"div",role:"image",attributes:void 0},parentSemantics:{label:"",elementType:"figure",role:"figure",attributes:void 0},existingElement:{useForSpatialProperties:!1,spatialProperties:void 0}}},607:(e,t,i)=>{var n=i(4),o=i(489),r=i(992);t.Z={structure:n.default,input:o.default,rendering:r.default}},489:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=i(312);t.default=function(e){var t={},i=n.defaultKeyBindings,o=n.GenericFullNavigationRules;return t.moveTo=function(t){var i=e.structure.nodes[t];if(i)return i},t.move=function(i,n){if(i){var r=e.structure.nodes[i];if(r.edges){var a=null,s=0,d=o[n];if(!d)return;var l=function(){var t=e.structure.edges[r.edges[s]];if(t.navigationRules.forEach((function(e){a||(a=function(e,t){if(e!==n)return null;var o={target:"string"==typeof t.target?t.target:t.target(r,i),source:"string"==typeof t.source?t.source:t.source(r,i)};return o[d.direction]!==i?o[d.direction]:null}(e,t))})),a)return"break"};for(s=0;s<r.edges.length&&"break"!==l();s++);return a?t.moveTo(a):void 0}}},t.enter=function(){return e.entryPoint?t.moveTo(e.entryPoint):void console.error("No entry point was specified in InputOptions, returning undefined")},t.exit=function(){return e.exitPoint?e.exitPoint:void console.error("No exit point was specified in InputOptions, returning undefined")},t.keydownValidator=function(e){var t=i[e.code];if(t)return t},t.focus=function(e){var t=document.getElementById(e);t&&t.focus()},t.setNavigationKeyBindings=function(e){e?(i={},o=e,Object.keys(e).forEach((function(t){var n=e[t];i[n.key]=t}))):(i=n.defaultKeyBindings,o=n.GenericFullNavigationRules)},t.setNavigationKeyBindings(e.navigationRules),t}},992:function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,o=0,r=t.length;o<r;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var r=i(312);t.default=function(e){var t=function(e){a.wrapper.setAttribute("aria-activedescendant",e.srcElement.id)},i=function(){a.wrapper.setAttribute("aria-activedescendant","")},a={},s=!1,d={cssClass:r.NodeElementDefaults.cssClass,spatialProperties:n({},r.NodeElementDefaults.spatialProperties),semantics:n({},r.NodeElementDefaults.semantics),parentSemantics:n({},r.NodeElementDefaults.parentSemantics),existingElement:n({},r.NodeElementDefaults.existingElement)};return e.defaults&&(d.cssClass=e.defaults.cssClass||d.cssClass,d.spatialProperties=e.defaults.spatialProperties?n(n({},d.spatialProperties),e.defaults.spatialProperties):d.spatialProperties,d.semantics=e.defaults.semantics?n(n({},d.semantics),e.defaults.semantics):d.semantics,d.parentSemantics=e.defaults.parentSemantics?n(n({},d.parentSemantics),e.defaults.parentSemantics):d.parentSemantics,d.existingElement=e.defaults.existingElement?n(n({},d.existingElement),e.defaults.existingElement):d.existingElement),a.initialize=function(){var t;if(s)console.error("The renderer wrapper has already been initialized successfully, RenderingOptions.suffixId is: ".concat(e.suffixId,". No further action was taken."));else if(e.root&&document.getElementById(e.root.id)){if(a.root=document.getElementById(e.root.id),a.root.style.position="relative",a.root.classList.add("dn-root"),e.suffixId)return a.wrapper=document.createElement("div"),a.wrapper.id="dn-wrapper-"+e.suffixId,a.wrapper.setAttribute("role","application"),a.wrapper.setAttribute("aria-label",e.root.description||"Data navigation structure"),a.wrapper.setAttribute("aria-activedescendant",""),a.wrapper.classList.add("dn-wrapper"),a.wrapper.style.width=e.root&&e.root.width?e.root.width:"100%",e.root&&e.root.height&&(a.wrapper.style.height=e.root.height),e.entryButton&&e.entryButton.include&&(a.entryButton=document.createElement("button"),a.entryButton.id="dn-entry-button-"+e.suffixId,a.entryButton.classList.add("dn-entry-button"),a.entryButton.innerText="Enter navigation area",e.entryButton.callbacks&&e.entryButton.callbacks.click&&a.entryButton.addEventListener("click",e.entryButton.callbacks.click),e.entryButton.callbacks&&e.entryButton.callbacks.focus&&a.entryButton.addEventListener("focus",e.entryButton.callbacks.focus),a.wrapper.appendChild(a.entryButton)),a.root.appendChild(a.wrapper),(null===(t=e.exitElement)||void 0===t?void 0:t.include)&&(a.exitElement=document.createElement("div"),a.exitElement.id="dn-exit-"+e.suffixId,a.exitElement.classList.add("dn-exit-position"),a.exitElement.innerText="End of data structure.",a.exitElement.setAttribute("aria-label","End of data structure."),a.exitElement.setAttribute("role","note"),a.exitElement.setAttribute("tabindex","-1"),a.exitElement.style.display="none",a.exitElement.addEventListener("focus",(function(t){var i,n;a.exitElement.style.display="block",a.clearStructure(),(null===(n=null===(i=e.exitElement)||void 0===i?void 0:i.callbacks)||void 0===n?void 0:n.focus)&&e.exitElement.callbacks.focus(t)})),a.exitElement.addEventListener("blur",(function(t){var i,n;a.exitElement.style.display="none",(null===(n=null===(i=e.exitElement)||void 0===i?void 0:i.callbacks)||void 0===n?void 0:n.blur)&&e.exitElement.callbacks.blur(t)})),a.root.appendChild(a.exitElement)),s=!0,a.root;console.error("No suffix id found: options.suffixId must be specified.")}else console.error("No root element found, cannot build: RenderingOptions.root.id must reference an existing DOM element in order to render children.")},a.render=function(n){var o=n.renderId+"",r=e.elementData[o];if(r){if(s){var l=!1,u={},c=function(e,t,i){var o=r[e]||d[e],a=i&&l?u[t]:o[t],s=d[e][t];return"function"==typeof o?o(r,n.datum):"function"==typeof a?a(r,n.datum):a||s||(t?void 0:o)};l=c("existingElement","useForSpatialProperties"),u=c("existingElement","spatialProperties");var v=parseFloat(c("spatialProperties","width",!0)||0),g=parseFloat(c("spatialProperties","height",!0)||0),p=parseFloat(c("spatialProperties","x",!0)||0),y=parseFloat(c("spatialProperties","y",!0)||0),f=document.createElement(c("parentSemantics","elementType")),m=c("parentSemantics","attributes");"object"==typeof m&&Object.keys(m).forEach((function(e){f.setAttribute(e,m[e])})),f.setAttribute("role",c("parentSemantics","role")),f.id=o,f.classList.add("dn-node"),f.classList.add(c("cssClass")),f.style.width=v+"px",f.style.height=g+"px",f.style.left=p+"px",f.style.top=y+"px",f.setAttribute("tabindex","0"),f.addEventListener("focus",t),f.addEventListener("blur",i);var h=document.createElement(c("semantics","elementType")),b=c("semantics","attributes");"object"==typeof b&&Object.keys(b).forEach((function(e){f.setAttribute(e,b[e])})),h.setAttribute("role",c("semantics","role")),h.classList.add("dn-node-text"),r.showText&&(h.innerText=r.semantics.label);var x=c("semantics","label");x||console.error("Accessibility error: a label must be supplied to every rendered element using semantics.label."),h.setAttribute("aria-label",x),f.appendChild(h);var k=c("spatialProperties","path");if(k){var E=v+p+10,w=g+y+10,O=document.createElementNS("http://www.w3.org/2000/svg","svg");O.setAttribute("width",E+""),O.setAttribute("height",w+""),O.setAttribute("viewBox","0 0 ".concat(E," ").concat(w)),O.style.left=-p+"px",O.style.top=-y+"px",O.classList.add("dn-node-svg"),O.setAttribute("role","presentation"),O.setAttribute("focusable","false");var I=document.createElementNS("http://www.w3.org/2000/svg","path");I.setAttribute("d",k),I.classList.add("dn-node-path"),O.appendChild(I),f.appendChild(O)}return a.wrapper.appendChild(f),f}console.error("render() was called before initialize(), renderer must be initialized first.")}else console.warn("Render data not found with renderId: ".concat(o,". Failed to render."))},a.remove=function(e){var n=document.getElementById(e);a.wrapper.getAttribute("aria-activedescendant")===e&&a.wrapper.setAttribute("aria-activedescendant",""),n&&(n.removeEventListener("focus",t),n.removeEventListener("blur",i),n.remove())},a.clearStructure=function(){o([],a.wrapper.children,!0).forEach((function(e){a.entryButton&&a.entryButton===e||a.remove(e.id)}))},a}},4:function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,o=0,r=t.length;o<r;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.buildStructure=t.buildRules=t.buildEdges=t.scaffoldDimensions=t.bulidNodes=t.addSimpleDataIDs=t.createValidId=t.buildNodeStructureFromVegaLite=void 0;var r=i(312),a=i(5);t.default=function(e){return"vega-lite"===e.dataType||"vl"===e.dataType||"Vega-Lite"===e.dataType?(0,t.buildNodeStructureFromVegaLite)(e):(0,t.buildStructure)(e)},t.buildNodeStructureFromVegaLite=function(e){var t=r.GenericLimitedNavigationRules,i={},n={},o={},s=0,d=e.groupInclusionCriteria?e.groupInclusionCriteria:function(){return!0},l=e.itemInclusionCriteria?e.itemInclusionCriteria:function(){return!0},u=e.datumInclusionCriteria?e.datumInclusionCriteria:function(){return!0},c=e.vegaLiteView._renderer._origin,v=e.vegaLiteView._scenegraph.root.items[0].mark.items[0],g=function(e,t){if(e["data-navigator-id"])return e["data-navigator-id"];var i="dn-node-".concat(t,"-").concat(s);return s++,e["data-navigator-id"]=i,i},p=function(t,n,r,s,d){var l=g(t,n),c="render-"+l,v=r||[0,0];i[l]={},i[l].d={},i[l].id=l,i[l].renderId=c,i[l].index=s,i[l].level=n,i[l].parent=d,o[c]={},o[c].renderId=c,o[c].spatialProperties={},o[c].spatialProperties.x=t.bounds.x1+v[0],o[c].spatialProperties.y=t.bounds.y1+v[1],o[c].spatialProperties.width=t.bounds.x2-t.bounds.x1,o[c].spatialProperties.height=t.bounds.y2-t.bounds.y1,o[c].cssClass="dn-vega-lite-node",t.datum&&Object.keys(t.datum).forEach((function(o){var r=t.datum[o];u(o,r,t.datum,n,e.vegaLiteSpec)&&(i[l].d[e.keyRenamingHash&&e.keyRenamingHash[o]?e.keyRenamingHash[o]:o]=r)})),o[c].semantics={},o[c].semantics.label=e.nodeDescriber?e.nodeDescriber(i[l].d,t,n):(0,a.describeNode)(i[l].d)},y=0;return v.items.forEach((function(t){if(d(t,y,e.vegaLiteSpec)){p(t,"group",c,y,v);var i=0,n=t.items[0].mark.items[0].items?t.items[0].mark.items[0]:t;n.items.forEach((function(o){l(o,i,t,e.vegaLiteSpec)&&p(o,"item",c,i,n),i++}))}y++})),Object.keys(i).forEach((function(t){i[t].edges=function(t){var o=i[t],r=o.index,a=o.level,s=o.parent,d=[],l=s.items[r-1];if(l){var u=g(l,a);if(i[u]){var c="".concat(u,"-").concat(o.id);d.push(c),n[c]||(n[c]={source:u,target:o.id,navigationRules:["left","right"]})}}var v=s.items[r+1];if(v){var p=g(v,a);if(i[p]){var y="".concat(o.id,"-").concat(p);d.push(y),n[y]||(n[y]={source:o.id,target:p,navigationRules:["left","right"]})}}if("group"===a&&s.items[r].items){var f=(s.items[r].items[0].mark.items[0].items||s.items[r].items)[0],m=g(f,"item");if(i[m]){var h="".concat(o.id,"-").concat(m);d.push(h),n[h]||(n[h]={source:o.id,target:m,navigationRules:["parent","child"]})}}else if("item"===a){var b=g(s,"group");if(i[b]){var x="".concat(b,"-").concat(o.id);d.push(x),n[x]||(n[x]={source:b,target:o.id,navigationRules:["parent","child"]})}}return e.exitFunction&&(d.push("any-exit"),n["any-exit"]||(n["any-exit"]={source:e.getCurrent,target:e.exitFunction,navigationRules:["exit"]})),d.push("any-undo"),n["any-undo"]||(n["any-undo"]={source:e.getCurrent,target:e.getPrevious,navigationRules:["undo"]}),d}(t)})),{nodes:i,edges:n,elementData:o,navigationRules:t}},t.createValidId=function(e){return"_"+e.replace(/[^a-zA-Z0-9_-]+/g,"_")},t.addSimpleDataIDs=function(e){var t=0,i={};e.data.forEach((function(n){var o="function"==typeof e.idKey?e.idKey(n):e.idKey;n[o]="_"+t,e.keysForIdGeneration&&e.keysForIdGeneration.forEach((function(e){e in n&&("string"==typeof n[e]?(i[e]||(i[e]=0),i[n[e]]||(i[n[e]]=0),n[o]+="_"+e+i[e]+"_"+n[e]+i[n[e]],i[e]++,i[n[e]]++):(i[e]||(i[e]=0),n[o]+="_"+e+i[e],i[e]++))})),t++}))},t.bulidNodes=function(e){var t={};return e.data.forEach((function(i){e.idKey||console.error("Building nodes. A key string must be supplied in options.idKey to specify the id keys of every node.");var n="function"==typeof e.idKey?e.idKey(i):e.idKey,o=i[n];if(o)if(t[o])console.error("Building nodes. Each id for data in options.data must be unique. This id is not unique: ".concat(o,"."));else{var r="function"==typeof e.renderIdKey?e.renderIdKey(i):e.renderIdKey;t[o]={id:o,edges:[],renderId:r?i[r]||"":i.renderIdKey||"",data:i}}else console.error("Building nodes. Each datum in options.data must contain an id. When matching the id key string ".concat(n,", this datum has no id: ").concat(JSON.stringify(i),"."))})),t},t.scaffoldDimensions=function(e,i){var a,s,d={};if(null===(s=null===(a=e.dimensions)||void 0===a?void 0:a.parentOptions)||void 0===s?void 0:s.addLevel0){var l=e.dimensions.parentOptions.addLevel0;i[l.id]=n(n({},l),{dimensionLevel:0})}var u=o([],r.GenericFullNavigationDimensions,!0);return e.data.forEach((function(r){var a=e.dimensions.values||[],s=0;a.forEach((function(a){var l,c,v,g,p,y,f;if(a.dimensionKey){if(a.dimensionKey in r){var m=r[a.dimensionKey],h="function"!=typeof(null===(l=a.operations)||void 0===l?void 0:l.filterFunction)||a.operations.filterFunction(r,a);if(void 0!==m&&h){if(a.type||(a.type="bigint"==typeof m||"number"==typeof m?"numerical":"categorical"),!d[a.dimensionKey]){var b="function"==typeof a.nodeId?a.nodeId(a,e.data):a.nodeId||(0,t.createValidId)(a.dimensionKey),x="function"==typeof a.renderId?a.renderId(a,e.data):a.renderId||b;d[a.dimensionKey]={dimensionKey:a.dimensionKey,nodeId:b,divisions:{},numericalExtents:[1/0,-1/0],type:a.type,sortFunction:(null===(c=a.operations)||void 0===c?void 0:c.sortFunction)||void 0,behavior:a.behavior||{extents:"circular"},navigationRules:a.navigationRules||{sibling_sibling:u.length?o([],u.shift(),!0):["previous_"+a.dimensionKey,"next_"+a.dimensionKey],parent_child:["parent_"+a.dimensionKey,"child"]}},i[b]={id:b,renderId:x,derivedNode:a.dimensionKey,edges:[],dimensionLevel:1,data:d[a.dimensionKey],renderingStrategy:a.renderingStrategy||"singleSquare"}}var k=d[a.dimensionKey],E=null;if("categorical"===a.type){var w="function"==typeof(null===(v=a.divisionOptions)||void 0===v?void 0:v.divisionNodeIds)?a.divisionOptions.divisionNodeIds(a.dimensionKey,m,s):k.nodeId+"_"+m;if(!(E=k.divisions[w])){E=k.divisions[w]={id:w,sortFunction:(null===(g=a.divisionOptions)||void 0===g?void 0:g.sortFunction)||void 0,values:{}};var O="function"==typeof(null===(p=a.divisionOptions)||void 0===p?void 0:p.divisionRenderIds)?a.divisionOptions.divisionRenderIds(a.dimensionKey,m,s):w;i[w]={id:w,renderId:O,derivedNode:a.dimensionKey,edges:[],dimensionLevel:2,data:n({},E),renderingStrategy:(null===(y=a.divisionOptions)||void 0===y?void 0:y.renderingStrategy)||"singleSquare"},i[w].data[a.dimensionKey]=m}}else{(E=k.divisions[k.nodeId])||(E=k.divisions[k.nodeId]={id:k.nodeId,sortFunction:(null===(f=a.divisionOptions)||void 0===f?void 0:f.sortFunction)||void 0,values:{}}),a.operations||(a.operations={});var I=a.operations.createNumericalSubdivisions;k.subdivisions="number"==typeof I&&I<1?1:I||1,1!==I&&(k.divisionOptions||(k.divisionOptions=a.divisionOptions),function(e,t){var i=t.numericalExtents[0],n=t.numericalExtents[1];t.numericalExtents[0]=i<e?i:e,t.numericalExtents[1]=n>e?n:e}(m,k))}var K="function"==typeof e.idKey?e.idKey(r):e.idKey;E.values[r[K]]=r}}s++}else console.error("Building nodes, parsing dimensions. Each dimension in options.dimensions must contain a dimensionKey. This dimension has no key: ".concat(JSON.stringify(a),"."))}))})),Object.keys(d).forEach((function(e){var t,n,o,r,a=d[e],s=a.divisions;if("numerical"===a.type){s[a.nodeId].values=Object.fromEntries(Object.entries(s[a.nodeId].values).sort((function(t,i){return"function"==typeof a.sortFunction?a.sortFunction(t[1],i[1],a):t[1][e]-i[1][e]})));var l=s[a.nodeId].values;if(a.numericalExtents[0]!==1/0&&1!==a.subdivisions){var u=Object.keys(l),c="function"==typeof a.subdivisions?a.subdivisions(e,l):a.subdivisions,v=(a.numericalExtents[1]-a.numericalExtents[0])/c,g=a.numericalExtents[0]+v,p=0;for(g=a.numericalExtents[0]+v;g<=a.numericalExtents[1];g+=v){var y="function"==typeof(null===(t=a.divisionOptions)||void 0===t?void 0:t.divisionNodeIds)?a.divisionOptions.divisionNodeIds(e,g,g):a.nodeId+"_"+g;a.divisions[y]={id:y,sortFunction:(null===(n=a.divisionOptions)||void 0===n?void 0:n.sortFunction)||void 0,values:{}};var f="function"==typeof(null===(o=a.divisionOptions)||void 0===o?void 0:o.divisionRenderIds)?a.divisionOptions.divisionRenderIds(e,g,g):y;i[y]={id:y,renderId:f,derivedNode:e,edges:[],data:a.divisions[y],dimensionLevel:2,renderingStrategy:(null===(r=a.divisionOptions)||void 0===r?void 0:r.renderingStrategy)||"singleSquare"};for(var m=!1;!m&&p<u.length;){var h=l[u[p]];h[e]<=g?a.divisions[y].values[h.id]=h:(g+=v,m=!0),p++}}delete s[e]}}else"function"==typeof a.sortFunction&&(a.divisions=Object.fromEntries(Object.entries(s).sort((function(e,t){return a.sortFunction(e[1],t[1],a)}))));Object.keys(a.divisions).forEach((function(e){var t=a.divisions[e];"function"==typeof t.sortFunction&&(t.values=Object.fromEntries(Object.entries(t.values).sort((function(e,i){return a.sortFunction(e[1],i[1],t)}))))}))})),e.dimensions.adjustDimensions&&(d=e.dimensions.adjustDimensions(d)),d},t.buildEdges=function(e,t,i){var n,r,a,s,d,l,u,c,v,g,p={},y=function(e,i){-1===t[e].edges.indexOf(i)&&t[e].edges.push(i)},f=function(t,i,n,r){var a="".concat(t,"-").concat(i),s=e.useDirectedEdges?"".concat(i,"-").concat(a):a,d=!r||"source"===r,l=!r||"target"===r,u=function(e){var r;p[e]?(r=p[e].navigationRules).push.apply(r,n||[]):p[e]={source:t,target:i,navigationRules:n?o([],n,!0):[]}};u(a),e.useDirectedEdges&&l&&u(s),d&&y(t,a),l&&y(i,s)};if(i&&Object.keys(i).length){var m=Object.keys(i),h=null===(a=null===(r=null===(n=e.dimensions)||void 0===n?void 0:n.parentOptions)||void 0===r?void 0:r.level1Options)||void 0===a?void 0:a.order,b=h||m,x=0,k=(null===(s=e.dimensions)||void 0===s?void 0:s.parentOptions)||{},E=(null===(l=null===(d=k.level1Options)||void 0===d?void 0:d.behavior)||void 0===l?void 0:l.extents)||"terminal",w=k.addLevel0,O=w?(null===(c=null===(u=k.level1Options)||void 0===u?void 0:u.navigationRules)||void 0===c?void 0:c.parent_child)||["parent","child"]:[],I=(null===(g=null===(v=k.level1Options)||void 0===v?void 0:v.navigationRules)||void 0===g?void 0:g.sibling_sibling)||["left","right"],K="string"==typeof b[0]?h?t[b[0]]:t[i[b[0]].nodeId]:b[0];w&&f(w.id,K.id,O,"source"),b.forEach((function(n){var o="string"==typeof n?h?t[n]:t[i[n].nodeId]:n;if(o!==n||t[o.id]||(t[o.id]=o),w&&(e.useDirectedEdges?f(o.id,w.id,O,"source"):f(w.id,o.id,O,"target")),x===b.length-1&&"circular"===E)f(o.id,K.id,I);else if(x===b.length-1&&"bridgedCustom"===E)f(o.id,k.level1Options.behavior.customBridgePost,I);else if(x<b.length-1){var r="string"==typeof b[x+1]?h?t[b[x+1]]:t[i[b[x+1]].nodeId]:b[x+1];f(o.id,r.id,I)}x||"bridgedCustom"!==E||f(k.level1Options.behavior.customBridgePost,o.id,I),x++})),m.forEach((function(t){var n,o=i[t],r=(null===(n=o.behavior)||void 0===n?void 0:n.extents)||"circular";o.divisions||console.error("Parsing dimensions. The dimension using the key ".concat(t," is missing the divisions property. dimension.divisions should be supplied. ").concat(JSON.stringify(o),"."));var a=Object.keys(o.divisions),s=o.divisions[a[0]];if(1!==a.length)f(o.nodeId,s.id,o.navigationRules.parent_child,"source");else{var d=Object.keys(s.values),l="function"==typeof e.idKey?e.idKey(s.values[d[0]]):e.idKey;f(o.nodeId,s.values[d[0]][l],o.navigationRules.parent_child,"source")}var u=0;a.forEach((function(t){var i=o.divisions[t];u!==a.length-1||"circular"!==r&&"bridgedCousins"!==r&&"bridgedCustom"!==r?u<a.length-1&&f(i.id,o.divisions[a[u+1]].id,o.navigationRules.sibling_sibling):f(i.id,o.divisions[a[0]].id,o.navigationRules.sibling_sibling);var n=Object.keys(i.values);e.useDirectedEdges?f(i.id,o.nodeId,o.navigationRules.parent_child,"source"):f(o.nodeId,i.id,o.navigationRules.parent_child,"target");var s="function"==typeof e.idKey?e.idKey(i.values[n[0]]):e.idKey;f(i.id,i.values[n[0]][s],o.navigationRules.parent_child,"source");var d=0;n.length>1&&n.forEach((function(t){var s=i.values[t],l="function"==typeof e.idKey?e.idKey(s):e.idKey,c=1!==a.length?i.id:o.nodeId;if(e.useDirectedEdges?f(s[l],c,o.navigationRules.parent_child,"source"):f(c,s[l],o.navigationRules.parent_child,"target"),d===n.length-1&&"circular"===r){var v="function"==typeof e.idKey?e.idKey(i.values[n[0]]):e.idKey;f(s[l],i.values[n[0]][v],o.navigationRules.sibling_sibling)}else d===n.length-1&&"bridgedCousins"===r?u!==a.length-1?(v="function"==typeof e.idKey?e.idKey(o.divisions[a[u+1]].values[n[0]]):e.idKey,f(s[l],o.divisions[a[u+1]].values[n[0]][v],o.navigationRules.sibling_sibling)):(v="function"==typeof e.idKey?e.idKey(o.divisions[a[0]].values[n[0]]):e.idKey,f(s[l],o.divisions[a[0]].values[n[0]][v],o.navigationRules.sibling_sibling)):d===n.length-1&&"bridgedCustom"===r?f(s[l],o.behavior.customBridgePost,o.navigationRules.sibling_sibling):d<n.length-1&&(v="function"==typeof e.idKey?e.idKey(i.values[n[d+1]]):e.idKey,f(s[l],i.values[n[d+1]][v],o.navigationRules.sibling_sibling));d||"bridgedCousins"!==r?d||"bridgedCustom"!==r||f(o.behavior.customBridgePrevious,s[l],o.navigationRules.sibling_sibling):0!==u?(v="function"==typeof e.idKey?e.idKey(o.divisions[a[u-1]].values[n[n.length-1]]):e.idKey,f(o.divisions[a[u-1]].values[n[n.length-1]][v],s[l],o.navigationRules.sibling_sibling)):(v="function"==typeof e.idKey?e.idKey(o.divisions[a[a.length-1]].values[n[n.length-1]]):e.idKey,f(o.divisions[a[a.length-1]].values[n[n.length-1]][v],s[l],o.navigationRules.sibling_sibling)),d++})),u++}))}))}return Object.keys(t).forEach((function(i){var n,o=t[i];(null===(n=e.genericEdges)||void 0===n?void 0:n.length)&&e.genericEdges.forEach((function(e){p[e.edgeId]||(p[e.edgeId]=e.edge),(!e.conditional||e.conditional&&e.conditional(o,e))&&o.edges.push(e.edgeId)}))})),p},t.buildRules=function(e,t,i){var a,s,d,l,u=e.navigationRules;if(!u){var c=Object.keys(i||{});c.length>6&&console.error("Building navigationRules. Dimension count is too high to automatically generate key commands. It is recommend you reduce your dimensions to 6 or fewer for end-user experience. If not, you must provide your own navigation rules in options.navigationRules. Details: Count is ".concat(c.length,". Dimensions counted: ").concat(c.join(", "),"."));var v={},g={},p={},y=o([],r.TypicallyUnreservedKeyPairs,!0),f=o([],r.TypicallyUnreservedKeys,!0),m=function(t,i){var r=t&&i,a=!1,s=!1;if((v[t]||g[t])&&(g[t]=n({},v[t]),a=!0),i&&(v[i]||g[i])&&(g[i]=n({},v[i]),s=!0),!r||a||s){if(!g[t]&&f.length){var d=f.shift(),l=[];y.forEach((function(e){d!==e[0]&&d!==e[1]&&l.push(e)})),y=l,g[t]={direction:e.useDirectedEdges?"target":"source",key:d}}if(i&&!g[i]&&f.length){var u=f.shift(),c=[];y.forEach((function(e){u!==e[0]&&u!==e[1]&&c.push(e)})),y=c,g[i]={direction:"target",key:u}}f.length||(g[t]||(p[t]=t),i&&!g[i]&&(p[i]=i))}else{y.length||console.error("Building navigationRules. Dimension count is too high to automatically generate key commands, we have run out of keyboard key pairs to assign. You must either provide your own navigation rules in options.navigationRules, provide rules when generating dimensions, or reduce dimension count.");var m=o([],y.shift(),!0);f.splice(f.indexOf(m[0]),1),f.splice(f.indexOf(m[1]),1),g[t]={direction:e.useDirectedEdges?"target":"source",key:m[0]},g[i]={direction:"target",key:m[1]}}};if(Object.keys(r.GenericFullNavigationRules).forEach((function(t){var i=n({},r.GenericFullNavigationRules[t]);e.useDirectedEdges&&(i.direction="target"),v[t]=i})),c.length){if(null===(s=null===(a=e.dimensions)||void 0===a?void 0:a.parentOptions)||void 0===s?void 0:s.addLevel0){var h=(null===(l=null===(d=e.dimensions.parentOptions.level1Options)||void 0===d?void 0:d.navigationRules)||void 0===l?void 0:l.parent_child)||["parent","child"];m(h[0],h[1])}c.forEach((function(e){var t=i[e].navigationRules.parent_child,n=i[e].navigationRules.sibling_sibling;m(t[0],t[1]),m(n[0],n[1])}))}if(Object.keys(t).forEach((function(e){t[e].navigationRules.forEach((function(e){g[e]||m(e)}))})),Object.keys(p).length){var b={};Object.keys(g).forEach((function(e){b[g[e].key]=g[e].key})),Object.keys(v).forEach((function(e){b[v[e].key]||r.SemanticKeys[v[e].key]||f.push(v[e].key)}));var x=n({},p);p={},Object.keys(x).forEach((function(e){m(e)})),Object.keys(p).length&&console.error("Building navigationRules. There are no more keys left to assign automatically. Recommended fixes: use fewer dimensions, use fewer GenericEdges, or build your own navigationRules. Rules remaining without keyboard keys: ".concat(Object.keys(p).join(", "),"."))}u=g}return u},t.buildStructure=function(e){e.addIds&&(0,t.addSimpleDataIDs)(e);var i=(0,t.bulidNodes)(e),n=(0,t.scaffoldDimensions)(e,i),o=(0,t.buildEdges)(e,i,n);return{nodes:i,edges:o,dimensions:n,navigationRules:(0,t.buildRules)(e,o,n)}}},5:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.describeNode=void 0,t.describeNode=function(e,t){var i=Object.keys(e),n="";return i.forEach((function(i){n+="".concat(t&&t.omitKeyNames?"":i+": ").concat(e[i],". ")})),n+=t&&t.semanticLabel||"Data point."}}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,i),r.exports}(()=>{var e=i(607),t=i(5);let n={};const o=(e,t,i)=>{let n=[];return t&&t.forEach((e=>{let t={id:e};n.push(t)})),Object.keys(e).forEach((t=>{if(i){let e=!1;if(i.forEach((i=>{t===i&&(e=!0)})),e)return}n.push(e[t])})),n},r=e=>{document.getElementById(e).classList.add("hidden")},a=(e,t,i,n)=>{const o=document.getElementById(t);o.classList.remove("hidden"),o.innerText=e.semantics?.label||`${e.id}${e.data?.[n]?", "+e.data[n]:""} (generic node, edges hidden).`;const r=o.getBoundingClientRect().height/2;o.style.textAlign="left",o.style.transform=`translate(${i}px,${i/2-r}px)`},s=(i,s,d,l,u,c,v)=>{let g,p,y;((e,i,n)=>{Object.keys(e).forEach((o=>{let r=e[o];r.renderId||(r.renderId=r.id);let a="";if(r.existingElement={useForSpatialProperties:!0,spatialProperties:()=>{let e=document.getElementById(i).querySelector("#svg"+r.renderId).getBBox();return{x:e.x+n/2-.91,y:e.y+n/2-.91,width:e.width,height:e.height}}},r.derivedNode)if(r.data.dimensionKey){let e=0,t=Object.keys(r.data.divisions);t.length&&t.forEach((t=>{e+=Object.keys(r.data.divisions[t].values).length})),a=`${r.derivedNode}.`,a+=t.length&&e?` Contains ${t.length} division${t.length>1?"s":""} which contain ${e} datapoint${e>1?"s":""} total.`:" Contains no child data points.",a+=` ${r.data.type} dimension.`}else a=`${r.derivedNode}: ${r.data[r.derivedNode]}. Contains ${Object.keys(r.data.values).length} child data point${Object.keys(r.data.values).length>1?"s":""}. Division of ${r.derivedNode} dimension.`;else a=(0,t.describeNode)(r.data,{});r.semantics={label:a}}))})(i.nodes,s,d);let f=function({nodes:e,links:t},{nodeId:i=(e=>e.id),nodeGroup:n,nodeGroups:o,nodeTitle:r,nodeFill:a="currentColor",nodeStroke:s="#fff",nodeStrokeWidth:d=1.5,nodeStrokeOpacity:l=1,nodeRadius:u=5,nodeStrength:c,linkSource:v=(({source:e})=>e),linkTarget:g=(({target:e})=>e),linkStroke:p="#999",linkStrokeOpacity:y=.6,linkStrokeWidth:f=1.5,linkStrokeLinecap:m="round",linkStrength:h,colors:b=d3.schemeTableau10,width:x=640,height:k=400,invalidation:E}={}){const w=d3.map(e,i).map(D),O="function"!=typeof u?null:d3.map(e,u),I=d3.map(t,v).map(D),K=d3.map(t,g).map(D);void 0===r&&(r=(e,t)=>w[t]);const R=null==r?null:d3.map(e,r),B=null==n?null:d3.map(e,n).map(D),_="function"!=typeof f?null:d3.map(t,f),j="function"!=typeof p?null:d3.map(t,p);e=d3.map(e,((e,t)=>({id:w[t]}))),t=d3.map(t,((e,t)=>({source:I[t],target:K[t]}))),B&&void 0===o&&(o=d3.sort(B));const A=null==n?null:d3.scaleOrdinal(o,b),S=d3.forceManyBody(),L=d3.forceLink(t).id((({index:e})=>w[e]));void 0!==c&&S.strength(c),void 0!==h&&L.strength(h);const N=d3.forceSimulation(e).force("link",L).force("charge",S).force("center",d3.forceCenter()).on("tick",(function(){C.attr("x1",(e=>e.source.x)).attr("y1",(e=>e.source.y)).attr("x2",(e=>e.target.x)).attr("y2",(e=>e.target.y)),P.attr("cx",(e=>{let t=x/2-u;return e.x>t||e.x<-t?t:e.x})).attr("cy",(e=>{let t=k/2-u;return e.y>t||e.y<-t?t:e.y}))})),G=d3.create("svg").attr("width",x).attr("height",k).attr("viewBox",[-x/2,-k/2,x,k]).attr("style","max-width: 100%; height: auto; height: intrinsic;"),C=G.append("g").attr("stroke","function"!=typeof p?p:null).attr("stroke-opacity",y).attr("stroke-width","function"!=typeof f?f:null).attr("stroke-linecap",m).selectAll("line").data(t).join("line"),P=G.append("g").attr("fill",a).attr("stroke",s).attr("stroke-opacity",l).attr("stroke-width",d).selectAll("circle").data(e).join("circle").attr("r",u).call(function(e){return d3.drag().on("start",(function(t){t.active||e.alphaTarget(.3).restart(),t.subject.fx=t.subject.x,t.subject.fy=t.subject.y})).on("drag",(function(e){e.subject.fx=e.x,e.subject.fy=e.y})).on("end",(function(t){t.active||e.alphaTarget(0),t.subject.fx=null,t.subject.fy=null}))}(N));function D(e){return null!==e&&"object"==typeof e?e.valueOf():e}return _&&C.attr("stroke-width",(({index:e})=>_[e])),j&&C.attr("stroke",(({index:e})=>j[e])),B&&P.attr("fill",(({index:e})=>A(B[e]))),O&&P.attr("r",(({index:e})=>O[e])),R&&P.append("title").text((({index:e})=>R[e])),null!=E&&E.then((()=>N.stop())),Object.assign(G.node(),{scales:{color:A}})}({nodes:o(i.nodes,c),links:o(i.edges,[],v)},{nodeId:e=>e.id,nodeGroup:e=>"dimensionLevel"===l?e.dimensionLevel:e.data?.[l],width:d,height:d});document.getElementById(s).appendChild(f),document.getElementById(s).querySelectorAll("circle").forEach((e=>{e.id="svg"+e.__data__?.id,e.addEventListener("mousemove",(e=>{if(e.target?.__data__?.id){let t=e.target.__data__;a(i.nodes[t.id]||t,`${s}-tooltip`,d,l)}})),e.addEventListener("mouseleave",(()=>{r(`${s}-tooltip`)}))})),n[s]=()=>{g=!1,m.exitElement.style.display="block",h.focus(m.exitElement.id),p=y,y=null,m.remove(p),r(`${s}-tooltip`)};const m=((t,i,n)=>e.Z.rendering({elementData:t.nodes,defaults:{cssClass:"dn-test-class"},suffixId:"data-navigator-schema-"+i,root:{id:"dn-root-"+i,cssClass:"",width:"100%",height:0},entryButton:{include:!0,callbacks:{click:()=>{(()=>{const e=h.enter();e&&b(e)})()}}},exitElement:{include:!0}}))(i,s);m.initialize();const h=e.Z.input({structure:i,navigationRules:i.navigationRules,entryPoint:u,exitPoint:m.exitElement.id}),b=e=>{const t=m.render({renderId:e.renderId,datum:e});t.addEventListener("keydown",(e=>{const t=h.keydownValidator(e);t&&(e.preventDefault(),(e=>{const t=h.move(y,e);t&&b(t)})(t))})),t.addEventListener("blur",(e=>{r(`${s}-tooltip`)})),t.addEventListener("focus",(t=>{a(e,`${s}-tooltip`,d,l)})),h.focus(e.renderId),g=!0,p=y,y=e.id,m.remove(p)}},d=[{id:"a",cat:"meow",num:3},{id:"b",cat:"meow",num:1},{id:"c",cat:"meow",num:2},{id:"d",cat:"bork",num:4}];let l=e.Z.structure({data:d,idKey:"id",dimensions:{values:[{dimensionKey:"cat",type:"categorical",behavior:{extents:"circular"}},{dimensionKey:"num",type:"numerical",behavior:{extents:"terminal"}}]},genericEdges:[{edgeId:"any-exit",edge:{source:(e,t)=>t,target:()=>(n.simple(),""),navigationRules:["exit"]}}]});console.log("simpleStructure",l),s(l,"simple",300,"dimensionLevel",l.dimensions[Object.keys(l.dimensions)[0]].nodeId,["exit"],["any-exit"]);let u=[];d.forEach((e=>{u.push({...e})})),u.push({id:"e",cat:"bork",num:12});let c=e.Z.structure({data:u,addIds:!0,idKey:"addedId",dimensions:{values:[{dimensionKey:"cat",nodeId:"_cat2",type:"categorical",behavior:{extents:"circular"}},{dimensionKey:"num",nodeId:(e,t)=>e.dimensionKey+"2",type:"numerical",behavior:{extents:"terminal"}}]},genericEdges:[{edgeId:"any-exit",edge:{source:(e,t)=>t,target:()=>(n.added(),""),navigationRules:["exit"]}},{edgeId:"test1",edge:{source:"testA",target:"testB",navigationRules:["test1"]}},{edgeId:"test2",edge:{source:"testA",target:"testB",navigationRules:["test2"]}},{edgeId:"test3",edge:{source:"testA",target:"testB",navigationRules:["test3"]}},{edgeId:"test4",edge:{source:"testA",target:"testB",navigationRules:["test4"]}},{edgeId:"test5",edge:{source:"testA",target:"testB",navigationRules:["test5"]}}]});console.log("addedDataStructure",c),s(c,"added",300,"dimensionLevel",c.dimensions[Object.keys(c.dimensions)[0]].nodeId,["exit"],["any-exit","test1","test2","test3","test4","test5"]);let v=e.Z.structure({data:[{date:"2016-01-01",category:"Group A",value:120,count:420},{date:"2016-02-01",category:"Group A",value:121,count:439},{date:"2016-03-01",category:"Group A",value:119,count:402},{date:"2016-04-01",category:"Group A",value:114,count:434},{date:"2016-05-01",category:"Group A",value:102,count:395},{date:"2016-06-01",category:"Group A",value:112,count:393},{date:"2016-07-01",category:"Group A",value:130,count:445},{date:"2016-08-01",category:"Group A",value:124,count:456},{date:"2016-09-01",category:"Group A",value:119,count:355},{date:"2016-10-01",category:"Group A",value:106,count:464},{date:"2016-11-01",category:"Group A",value:123,count:486},{date:"2016-12-01",category:"Group A",value:133,count:491},{date:"2016-01-01",category:"Group B",value:89,count:342},{date:"2016-02-01",category:"Group B",value:93,count:434},{date:"2016-03-01",category:"Group B",value:82,count:378},{date:"2016-04-01",category:"Group B",value:92,count:323},{date:"2016-05-01",category:"Group B",value:90,count:434},{date:"2016-06-01",category:"Group B",value:85,count:376},{date:"2016-07-01",category:"Group B",value:88,count:404},{date:"2016-08-01",category:"Group B",value:84,count:355},{date:"2016-09-01",category:"Group B",value:90,count:432},{date:"2016-10-01",category:"Group B",value:80,count:455},{date:"2016-11-01",category:"Group B",value:92,count:445},{date:"2016-12-01",category:"Group B",value:97,count:321},{date:"2016-01-01",category:"Group C",value:73,count:456},{date:"2016-02-01",category:"Group C",value:74,count:372},{date:"2016-03-01",category:"Group C",value:68,count:323},{date:"2016-04-01",category:"Group C",value:66,count:383},{date:"2016-05-01",category:"Group C",value:72,count:382},{date:"2016-06-01",category:"Group C",value:70,count:365},{date:"2016-07-01",category:"Group C",value:74,count:296},{date:"2016-08-01",category:"Group C",value:68,count:312},{date:"2016-09-01",category:"Group C",value:75,count:334},{date:"2016-10-01",category:"Group C",value:66,count:386},{date:"2016-11-01",category:"Group C",value:85,count:487},{date:"2016-12-01",category:"Group C",value:89,count:512},{date:"2016-01-01",category:"Other",value:83,count:432},{date:"2016-02-01",category:"Other",value:87,count:364},{date:"2016-03-01",category:"Other",value:76,count:334},{date:"2016-04-01",category:"Other",value:86,count:395},{date:"2016-05-01",category:"Other",value:87,count:354},{date:"2016-06-01",category:"Other",value:77,count:386},{date:"2016-07-01",category:"Other",value:79,count:353},{date:"2016-08-01",category:"Other",value:85,count:288},{date:"2016-09-01",category:"Other",value:87,count:353},{date:"2016-10-01",category:"Other",value:76,count:322},{date:"2016-11-01",category:"Other",value:96,count:412},{date:"2016-12-01",category:"Other",value:104,count:495}],idKey:"id",addIds:!0,dimensions:{values:[{dimensionKey:"date",type:"categorical",behavior:{extents:"circular"},operations:{sortFunction:(e,t,i)=>{if(e.values)return new Date(e.values[Object.keys(e.values)[0]].date)-new Date(t.values[Object.keys(t.values)[0]].date)}}},{dimensionKey:"category",type:"categorical",behavior:{extents:"circular"}}]},genericEdges:[{edgeId:"any-exit",edge:{source:(e,t)=>t,target:()=>(n.larger(),""),navigationRules:["exit"]}}]});console.log("largerStructure",v),s(v,"larger",300,"dimensionLevel",v.dimensions[Object.keys(v.dimensions)[0]].nodeId,["exit"],["any-exit"])})()})();